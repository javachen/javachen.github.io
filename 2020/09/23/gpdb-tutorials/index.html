<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Greenplum Database Tutorials - 六月陈书</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="junetalk" /><meta name="description" content="介绍 Greenplum官方有一个 Greenplum Database Tutorials ，里面是使用的虚拟机，本文使用 docker 容器部署一个 Greenplum 实例进行测试。 如果你不想使用docker部署，可以参考我" /><meta name="keywords" content="Java, Hadoop, Docker, Kubernetes" />


<meta name="baidu-site-verification" content="OMsbiDfo1G" />



<meta name="generator" content="Hugo 0.54.0 with theme even" />


<link rel="canonical" href="https://junetalk.github.io/2020/09/23/gpdb-tutorials/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.9a8d6025.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="Greenplum Database Tutorials" />
<meta property="og:description" content="介绍 Greenplum官方有一个 Greenplum Database Tutorials ，里面是使用的虚拟机，本文使用 docker 容器部署一个 Greenplum 实例进行测试。 如果你不想使用docker部署，可以参考我" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://junetalk.github.io/2020/09/23/gpdb-tutorials/" />
<meta property="article:published_time" content="2020-09-23T00:00:00&#43;08:00"/>
<meta property="article:modified_time" content="2020-09-23T00:00:00&#43;08:00"/>

<meta itemprop="name" content="Greenplum Database Tutorials">
<meta itemprop="description" content="介绍 Greenplum官方有一个 Greenplum Database Tutorials ，里面是使用的虚拟机，本文使用 docker 容器部署一个 Greenplum 实例进行测试。 如果你不想使用docker部署，可以参考我">


<meta itemprop="datePublished" content="2020-09-23T00:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2020-09-23T00:00:00&#43;08:00" />
<meta itemprop="wordCount" content="2720">



<meta itemprop="keywords" content="greenplum," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Greenplum Database Tutorials"/>
<meta name="twitter:description" content="介绍 Greenplum官方有一个 Greenplum Database Tutorials ，里面是使用的虚拟机，本文使用 docker 容器部署一个 Greenplum 实例进行测试。 如果你不想使用docker部署，可以参考我"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">六月陈书</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">六月陈书</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Greenplum Database Tutorials</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-09-23 </span>
        <div class="post-category">
            <a href="/categories/greenplum/"> greenplum </a>
            </div>
          <span class="more-meta"> 约 2720 字 </span>
          <span class="more-meta"> 预计阅读 6 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#介绍">介绍</a></li>
<li><a href="#准备环境">准备环境</a>
<ul>
<li><a href="#docker-部署">docker 部署</a></li>
</ul></li>
<li><a href="#测试">测试</a>
<ul>
<li><a href="#准备测试数据">准备测试数据</a></li>
<li><a href="#创建用户和角色">创建用户和角色</a></li>
<li><a href="#创建数据库">创建数据库</a></li>
<li><a href="#创建schema">创建schema</a></li>
<li><a href="#创建表">创建表</a></li>
<li><a href="#加载数据">加载数据</a></li>
<li><a href="#查询和性能调优">查询和性能调优</a>
<ul>
<li><a href="#analyze">Analyze</a></li>
<li><a href="#查看执行计划">查看执行计划</a></li>
<li><a href="#修改优化器">修改优化器</a></li>
<li><a href="#索引">索引</a></li>
<li><a href="#行和列">行和列</a></li>
<li><a href="#查看segments数据">查看segments数据</a></li>
<li><a href="#分区">分区</a></li>
<li><a href="#集成分析工具">集成分析工具</a></li>
<li><a href="#备份和恢复操作">备份和恢复操作</a></li>
</ul></li>
</ul></li>
<li><a href="#参考文章">参考文章</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h1 id="介绍">介绍</h1>

<p>Greenplum官方有一个 <a href="http://greenplum-db.github.io/gpdb-sandbox-tutorials/">Greenplum Database Tutorials</a> ，里面是使用的虚拟机，本文使用 docker 容器部署一个 Greenplum 实例进行测试。</p>

<p>如果你不想使用docker部署，可以参考我写的这篇文章：<a href="/2019/11/20/install-greenplum-cluster/">安装Greenplum数据库集群</a>。</p>

<h1 id="准备环境">准备环境</h1>

<h2 id="docker-部署">docker 部署</h2>

<p>安装 docker：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">curl -fsSL get.docker.com -o get-docker.sh
sudo sh get-docker.sh --mirror Aliyun

sudo systemctl <span class="nb">enable</span> docker
sudo systemctl start docker</code></pre></td></tr></table>
</div>
</div>
<p>使用如下命令拉取这个镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">docker pull pivotaldata/gpdb-devel</pre></td></tr></table>
</div>
</div>
<p>下载官方示例数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">cd ~
git clone https://github.com/greenplum-db/gpdb-sandbox-tutorials.git
cd gpdb-sandbox-tutorials
tar zxf faa.tar.gz</pre></td></tr></table>
</div>
</div>
<p>启动GP容器，并挂载上述教程示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">docker rm $(docker ps -aq)

docker run -it -d \
  -p 15432:15432 \
  --name gp_tutorials \
  --hostname gp-tutorials \
  -v ~/gpdb-sandbox-tutorials:/tutorials \
  --restart always \
  pivotaldata/gpdb-devel </pre></td></tr></table>
</div>
</div>
<p>进入容器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">docker exec -it gp_tutorials bash</pre></td></tr></table>
</div>
</div>
<p>首次切换gpadmin用户，会自动启动gp数据库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">bash-4.1# su gpadmin</pre></td></tr></table>
</div>
</div>
<p>修改pgdb的配置文件，允许客户端所在网络可以连接，需要重启才能生效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /workspace/gpdb/gpAux/gpdemo/datadirs/qddir/demoDataDir-1 

vi pg_hba.conf 
<span class="c1">#添加 host all all 172.17.0.2/32 trust</span> 

gpstop -r </code></pre></td></tr></table>
</div>
</div>
<p>最后，总结一下，容器中数据库说明如下：</p>

<ul>
<li>Greenplum 版本为：4.3.99.00，安装路径为：/usr/local/gpdb</li>
<li>PostgreSQL 版本为：8.3.23</li>
<li>工作空间：/workspace/gpdb</li>
</ul>

<h1 id="测试">测试</h1>

<h2 id="准备测试数据">准备测试数据</h2>

<p>进入容器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker <span class="nb">exec</span> -it gp_tutorials bash
su - gpadmin
<span class="nb">cd</span> /tutorials/</code></pre></td></tr></table>
</div>
</div>
<h2 id="创建用户和角色">创建用户和角色</h2>

<p>1、方式1：使用createuser工具创建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ createuser -P user1
Enter password <span class="k">for</span> new role:
Enter it again:
Shall the new role be a superuser? <span class="o">(</span>y/n<span class="o">)</span> n
Shall the new role be allowed to create databases? <span class="o">(</span>y/n<span class="o">)</span> y
Shall the new role be allowed to create more new roles? <span class="o">(</span>y/n<span class="o">)</span> n
NOTICE:  resource queue required -- using default resource queue
<span class="s2">&#34;pg_default&#34;</span></code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>创建 user1 用户，设置密码，并分配创建db权限，也可以使用下面命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></pre></td>
<td class="lntd">
<pre class="chroma">&gt; createuser -P user1 -d
&gt; ```

2、方式2：使用psql创建

```sql
psql template1

template1=# CREATE USER user2 WITH PASSWORD &#39;pivotal&#39; NOSUPERUSER;

template1=# \du
                       List of roles
 Role name |            Attributes             | Member of
-----------+-----------------------------------+-----------
 gpadmin   | Superuser, Create role, Create DB | {}
 user1     | Create DB                         | {}
 user2     |                                   | {}</pre></td></tr></table>
</div>
</div></blockquote>

<p>创建用户组，并将用户添加到该组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">template1</span><span class="o">=#</span> <span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">users</span><span class="p">;</span>
<span class="n">template1</span><span class="o">=#</span> <span class="k">GRANT</span> <span class="n">users</span> <span class="k">TO</span> <span class="n">user1</span><span class="p">,</span> <span class="n">user2</span><span class="p">;</span>

<span class="n">template1</span><span class="o">=#</span> <span class="err">\</span><span class="n">du</span>
                       <span class="n">List</span> <span class="k">of</span> <span class="n">roles</span>
 <span class="k">Role</span> <span class="n">name</span> <span class="o">|</span>            <span class="n">Attributes</span>             <span class="o">|</span> <span class="n">Member</span> <span class="k">of</span>
<span class="c1">-----------+-----------------------------------+-----------
</span><span class="c1"></span> <span class="n">gpadmin</span>   <span class="o">|</span> <span class="n">Superuser</span><span class="p">,</span> <span class="k">Create</span> <span class="k">role</span><span class="p">,</span> <span class="k">Create</span> <span class="n">DB</span> <span class="o">|</span> <span class="err">{}</span>
 <span class="n">user1</span>     <span class="o">|</span> <span class="k">Create</span> <span class="n">DB</span>                         <span class="o">|</span> <span class="err">{</span><span class="n">users</span><span class="err">}</span>
 <span class="n">user2</span>     <span class="o">|</span>                                   <span class="o">|</span> <span class="err">{</span><span class="n">users</span><span class="err">}</span>
 <span class="n">users</span>     <span class="o">|</span> <span class="n">Cannot</span> <span class="n">login</span>                      <span class="o">|</span> <span class="err">{}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="创建数据库">创建数据库</h2>

<p>1、使用命令行工具创建数据库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">dropdb tutorial
createdb tutorial


psql -U user1 -h `hostname` tutorial</pre></td></tr></table>
</div>
</div>
<p>查看数据库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">bash-4.1$ psql -l
                  List of databases
   Name    <span class="p">|</span>  Owner  <span class="p">|</span> Encoding <span class="p">|</span>  Access privileges
-----------+---------+----------+---------------------
 postgres  <span class="p">|</span> gpadmin <span class="p">|</span> UTF8     <span class="p">|</span>
 template0 <span class="p">|</span> gpadmin <span class="p">|</span> UTF8     <span class="p">|</span> <span class="o">=</span>c/gpadmin
                                : <span class="nv">gpadmin</span><span class="o">=</span>CTc/gpadmin
 template1 <span class="p">|</span> gpadmin <span class="p">|</span> UTF8     <span class="p">|</span> <span class="o">=</span>c/gpadmin
                                : <span class="nv">gpadmin</span><span class="o">=</span>CTc/gpadmin
 tutorial  <span class="p">|</span> gpadmin <span class="p">|</span> UTF8     <span class="p">|</span>
<span class="o">(</span><span class="m">4</span> rows<span class="o">)</span></code></pre></td></tr></table>
</div>
</div>
<p>授权 tutorial 数据库给 user1、user2 用户：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ psql -U gpadmin tutorial
<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># GRANT ALL PRIVILEGES ON DATABASE tutorial TO user1, user2;</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1">#  \q</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="创建schema">创建schema</h2>

<p>先切换到示例数据目录，再执行创建语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/gpdb-sandbox-tutorials/faa
$ psql -U user1 -h <span class="sb">`</span>hostname<span class="sb">`</span> tutorial

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># DROP SCHEMA IF EXISTS faa CASCADE;</span>
<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># CREATE SCHEMA faa;</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># SET SEARCH_PATH TO faa, public, pg_catalog, gp_toolkit;</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># SHOW search_path;</span>
             search_path
-------------------------------------
 faa, public, pg_catalog, gp_toolkit
<span class="o">(</span><span class="m">1</span> row<span class="o">)</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># ALTER ROLE user1 SET search_path TO faa, public, pg_catalog, gp_toolkit;</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \q</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="创建表">创建表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> ~/gpdb-sandbox-tutorials/faa

$ psql -U user1 -h <span class="sb">`</span>hostname<span class="sb">`</span> tutorial

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \i create_dim_tables.sql</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \dt</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \q</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="加载数据">加载数据</h2>

<p>1、使用 COPY 命令</p>

<p>使用COPY方式加载外部文件，可以指定文件类型、文件格式、日志信息，greenplum便会自动解析，将数据加载到目标表，这种方式比单纯的insert语句效率高，但它不是并行的，适合于加载少量数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ cd /tutorials/faa

tutorial-# =# \i copy_into_airlines.sql
tutorial-# =# \i copy_into_airports.sql
tutorial-# =# \i copy_into_delay_groups.sql
tutorial-# =# \i copy_into_distance_groups.sql
tutorial-# =# \i copy_into_wac.sql</pre></td></tr></table>
</div>
</div>
<p>2、使用 gpdist 加载数据</p>

<p>gpfdist程序运行在数据存放的节点上，它将数据均匀分布到每个节点上，它是并行工作的，文件可以是按照特定格式存储后压缩的gzip文件，也可以是未压缩的原文件；这种方式适用于大数据加载。</p>

<p>需要先创建gpfdist进程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ gpfdist -d /tutorials/faa -p <span class="m">8081</span> &gt; /tmp/gpfdist.log <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>

$ ps -A <span class="p">|</span> grep gpfdist

more /tmp/gpfdist.log</code></pre></td></tr></table>
</div>
</div>
<p>gpfdist类似文件服务器，需要指定端口，文件目录信息；gpfdist创建以后需要创建一张external table</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ psql -U gpadmin tutorial

tutorial=# \i create_load_tables.sql

tutorial=# \i create_ext_table.sql</pre></td></tr></table>
</div>
</div>
<p>因为gpfdist要将数据均匀的分布到每个节点上，所以创建EXTERNAL TABLE时LOCATION中指定的地址要是集群内的节点能够访问的地址，如果指定为127.0.0.1仅仅是当前服务器可以访问，其它节点访问不了，系统会报错拒绝连接。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=#  INSERT INTO faa.faa_otp_load SELECT * FROM faa.ext_load_otp;

tutorial=# select count(*) from faa.faa_otp_load;
  count  
---------
 1024552
(1 row)

tutorial=# \q</pre></td></tr></table>
</div>
</div>
<p>Greenplum也支持通过external table对外部文件的访问，但数据不能存放到内存中，每次操作成本很高。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# select count(*) from faa.ext_load_otp; 
NOTICE:  Found 26526 data formatting errors (26526 or more input rows). Rejected related input data.
  count  
---------
 1024552
(1 row)</pre></td></tr></table>
</div>
</div>
<p>最后停止gpfdist进程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">ps -A | grep gpfdist

killall gpfdist</pre></td></tr></table>
</div>
</div>
<p>3、使用 gpload 加载数据</p>

<p>gpfdist的操作需要我们一步步的配置和执行，Greenplum提供了一个封装好的依赖配置的工具GPLOAD。</p>

<p>首先我们创建所需的配置文件gpload01.yaml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">vi gpload.yaml
---
VERSION: <span class="m">1</span>.0.0.1
<span class="c1"># describe the Greenplum database parameters</span>
DATABASE: tutorial
USER: gpadmin
HOST: localhost
PORT: <span class="m">5432</span>
<span class="c1"># describe the location of the source files</span>
<span class="c1"># in this example, the database master lives on the same host as the source files</span>
GPLOAD:
   INPUT:
    - SOURCE:
         LOCAL_HOSTNAME:
           - gpdb-sandbox
         PORT: <span class="m">8081</span>
         FILE:
           - /Users/gpadmin/gpdb-sandbox-tutorials/faa/otp*.gz
    - FORMAT: csv
    - QUOTE: <span class="s1">&#39;&#34;&#39;</span>
    - ERROR_LIMIT: <span class="m">50000</span>
    - ERROR_TABLE: faa.faa_load_errors
   OUTPUT:
    - TABLE: faa.faa_otp_load
    - MODE: INSERT
   PRELOAD:
    - TRUNCATE: true</code></pre></td></tr></table>
</div>
</div>
<p>注意检查端口是否被占用，文件路径是否正确；最后执行加载数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gpload -f gpload.yaml -l gpload.log</pre></td></tr></table>
</div>
</div>
<p>日志提示临时创建的external table，数据插入、更新、错误信息，还提示怎么查看错误数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# select count(*) from faa.faa_otp_load;
  count  
---------
 1024552
(1 row)</pre></td></tr></table>
</div>
</div>
<p>GPLOAD提供更多的支持和自动化操作，也更方便定制某些特殊的操作，比如监控和统计。</p>

<p>4、创建和加载事实表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ psql -U gpadmin tutorial
<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \i create_fact_tables.sql</span>

<span class="nv">tutorial</span><span class="o">=</span><span class="c1"># \i load_into_fact_table.sql</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="查询和性能调优">查询和性能调优</h2>

<h3 id="analyze">Analyze</h3>

<p>在加载数据之后，建议对表进行分析一下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# ANALYZE faa.d_airports;
ANALYZE
tutorial=# ANALYZE faa.d_airlines;
ANALYZE
tutorial=# ANALYZE faa.d_wac;
ANALYZE
tutorial=# ANALYZE faa.d_cancellation_codes;
ANALYZE
tutorial=# ANALYZE faa.faa_otp_load;
ANALYZE
tutorial=# ANALYZE faa.otp_r;
ANALYZE
tutorial=# ANALYZE faa.otp_c;
ANALYZE</pre></td></tr></table>
</div>
</div>
<h3 id="查看执行计划">查看执行计划</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# \timing on
tutorial=# \i create_sample_table.sql
tutorial=# EXPLAIN SELECT COUNT(*) FROM sample WHERE id &gt; 100;
tutorial=# EXPLAIN ANALYZE SELECT COUNT(*) FROM sample WHERE id &gt; 100;</pre></td></tr></table>
</div>
</div>
<h3 id="修改优化器">修改优化器</h3>

<p>查看优化器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gpconfig -s optimizer
Values on all segments are consistent
GUC          : optimizer
Master  value: off
Segment value: off</pre></td></tr></table>
</div>
</div>
<p>开启优化器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">gpconfig -c optimizer -v on --masteronly</pre></td></tr></table>
</div>
</div>
<p>重新加载：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">gpstop -u</pre></td></tr></table>
</div>
</div>
<h3 id="索引">索引</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></pre></td>
<td class="lntd">
<pre class="chroma">psql -U gpadmin tutorial

tutorial=# \i create_sample_table.sql

tutorial=# SELECT * from sample WHERE big = 12345;
   id    |  big  | wee | stuff
---------+-------+-----+-------
   12345 | 12345 |   0 |
 1012346 | 12345 |   0 |
 2012347 | 12345 |   0 |
(3 rows)

tutorial=# EXPLAIN SELECT * from sample WHERE big = 12345;

tutorial=# CREATE INDEX sample_big_index ON sample(big);

tutorial=# EXPLAIN SELECT * FROM sample WHERE big = 12345;</pre></td></tr></table>
</div>
</div>
<h3 id="行和列">行和列</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# CREATE TABLE FAA.OTP_C (LIKE faa.otp_r) WITH (appendonly=true,orientation=column)DISTRIBUTED BY (UniqueCarrier, FlightNum) PARTITION BY RANGE(FlightDate)(PARTITION mth START(&#39;2009-06-01&#39;::date) END (&#39;2010-10-31&#39;::date) EVERY (&#39;1 mon&#39;::interval));

tutorial=# INSERT INTO faa.otp_c SELECT * FROM faa.otp_r;

tutorial=# \d faa.otp_r

tutorial=# \d faa.otp_c

tutorial=# SELECT pg_size_pretty(pg_relation_size(&#39;faa.otp_r&#39;));
 pg_size_pretty
----------------
 256 MB
(1 row)

tutorial=# SELECT pg_size_pretty(pg_total_relation_size(&#39;faa.otp_r&#39;));
 pg_size_pretty
----------------
 256 MB
(1 row)

tutorial=# SELECT pg_size_pretty(pg_relation_size(&#39;faa.otp_c&#39;));
 pg_size_pretty
----------------
 0 bytes
(1 row)

tutorial=# SELECT pg_size_pretty(pg_total_relation_size(&#39;faa.otp_c&#39;));
 pg_size_pretty
----------------
 288 kB
(1 row)

tutorial=#
tutorial=# SELECT pg_size_pretty(pg_total_relation_size(&#39;faa.otp_c&#39;));
 pg_size_pretty
----------------
 288 kB
(1 row)</pre></td></tr></table>
</div>
</div>
<h3 id="查看segments数据">查看segments数据</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# SELECT gp_segment_id, COUNT(*) FROM faa.otp_c GROUP BY gp_segment_id ORDER BY gp_segment_id;</pre></td></tr></table>
</div>
</div>
<h3 id="分区">分区</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">tutorial=# \timing on

tutorial=#  SELECT MAX(depdelay) FROM faa.otp_c WHERE UniqueCarrier = &#39;UA&#39;;

tutorial=# SELECT MAX(depdelay) FROM faa.otp_c WHERE flightdate =&#39;2009-11-01&#39;;</pre></td></tr></table>
</div>
</div>
<h3 id="集成分析工具">集成分析工具</h3>

<ul>
<li><a href="http://madlib.incubator.apache.org/">http://madlib.incubator.apache.org</a></li>
<li><a href="https://zeppelin.incubator.apache.org/">https://zeppelin.incubator.apache.org</a></li>
</ul>

<h3 id="备份和恢复操作">备份和恢复操作</h3>

<p>并行备份和恢复使用 gpbackup 和 gprestore ，下载地址：<a href="https://network.pivotal.io/products/pivotal-gpdb-backup-restore">https://network.pivotal.io/products/pivotal-gpdb-backup-restore</a></p>

<p>非并行使用 pg_dump。</p>

<p>备份：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">gpbackup --dbname tutorial</pre></td></tr></table>
</div>
</div>
<p>备份后的文件保存在：<code>$MASTER_DATA_DIRECTORY/backups/&lt;YYYYMMDD&gt;/&lt;YYYYMMDDHHMMSS&gt;/</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ll /gpdata/master/gpseg-1/backups/20200925</pre></td></tr></table>
</div>
</div>
<p>指定保存路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">gpbackup --dbname tutorial --backup-dir /home/gpadmin/backups
find /home/gpadmin/backups/ -type f</pre></td></tr></table>
</div>
</div>
<p>还原数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ dropdb tutorial
$ gprestore --timestamp 20200925045206 --create-db</pre></td></tr></table>
</div>
</div>
<p>指定任务数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gprestore --timestamp 20200925045206 --create-db --jobs 8</pre></td></tr></table>
</div>
</div>
<p>查看报告：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">cd /gpdata/master/gpseg-1/backups/20200925/20200925045206

cat gpbackup_20200925045206_report

cat gprestore_20200925045206_20200925045320_report</pre></td></tr></table>
</div>
</div>
<p>指定schema备份：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gpbackup --dbname demo --include-schema wikipedia
$ gpbackup --dbname demo --exclude-schema twitter

$ gpbackup --dbname demo --include-schema wikipedia --include-schema twitter</pre></td></tr></table>
</div>
</div>
<p>通过文件指定：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">gpbackup --dbname demo --include-schema-file /users/home/gpadmin/backup-schemas</pre></td></tr></table>
</div>
</div>
<p>指定表备份：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gpbackup --dbname demo --include-table-file /home/gpadmin/table-list.txt</pre></td></tr></table>
</div>
</div>
<p>可以同时指定：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ gpbackup --dbname demo --include-schema mydata --exclude-table mydata.addresses</pre></td></tr></table>
</div>
</div>
<h1 id="参考文章">参考文章</h1>

<ul>
<li><a href="http://greenplum-db.github.io/gpdb-sandbox-tutorials">http://greenplum-db.github.io/gpdb-sandbox-tutorials</a></li>
<li><a href="https://developer.aliyun.com/article/57656">https://developer.aliyun.com/article/57656</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">junetalk</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2020-09-23
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechat.jpg">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay.jpg">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/greenplum/">greenplum</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2020/09/24/greenplum-spark-connector-usage/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Pivotal Greenplum-Spark Connector</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2020/03/20/k3s-cert-manager-letsencrypt/">
            <span class="next-text nav-default">TLS on K3s with traefik, cert manger and letsencrypt</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="junetalk/junetalk.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:junecloud@163.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/javachen" class="iconfont icon-github" title="github"></a>
      <a href="http://weibo.com/chenzhijun" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://space.bilibili.com/287563020/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://junetalk.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2009 - 
    2021
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">junetalk</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.e1476869.min.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?7eaf37274cf8796df56903a88389e82f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>




</body>
</html>

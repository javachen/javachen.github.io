<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>安装单节点Ceph集群 - JavaChen Blog - Ramblings of a coder</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="JavaChen" /><meta name="description" content="本文主要记录在虚拟机中安装Ceph单节点集群的过程，其实多配置几个节点，也就是安装集群的过程。 Ceph中午文档：http://docs.ce" /><meta name="keywords" content="Java, Hadoop, Docker" />


<meta name="baidu-site-verification" content="OMsbiDfo1G" />



<meta name="generator" content="Hugo 0.58.3 with theme even" />


<link rel="canonical" href="https://blog.javachen.space/2019/11/24/install-ceph-sinle-node/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.5d87ca31.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="安装单节点Ceph集群" />
<meta property="og:description" content="本文主要记录在虚拟机中安装Ceph单节点集群的过程，其实多配置几个节点，也就是安装集群的过程。 Ceph中午文档：http://docs.ce" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.javachen.space/2019/11/24/install-ceph-sinle-node/" />
<meta property="article:published_time" content="2019-11-24T08:00:00+08:00" />
<meta property="article:modified_time" content="2019-11-24T08:00:00+08:00" />
<meta itemprop="name" content="安装单节点Ceph集群">
<meta itemprop="description" content="本文主要记录在虚拟机中安装Ceph单节点集群的过程，其实多配置几个节点，也就是安装集群的过程。 Ceph中午文档：http://docs.ce">


<meta itemprop="datePublished" content="2019-11-24T08:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-11-24T08:00:00&#43;08:00" />
<meta itemprop="wordCount" content="3105">



<meta itemprop="keywords" content="ceph," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="安装单节点Ceph集群"/>
<meta name="twitter:description" content="本文主要记录在虚拟机中安装Ceph单节点集群的过程，其实多配置几个节点，也就是安装集群的过程。 Ceph中午文档：http://docs.ce"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">JavaChen Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">JavaChen Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">安装单节点Ceph集群</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-11-24 </span>
        <div class="post-category">
            <a href="/categories/ceph/"> ceph </a>
            </div>
          <span class="more-meta"> 约 3105 字 </span>
          <span class="more-meta"> 预计阅读 7 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#集群规划">集群规划</a></li>
<li><a href="#准备环境">准备环境</a>
<ul>
<li><a href="#安装-ceph-部署工具">安装 CEPH 部署工具</a></li>
<li><a href="#ceph-节点安装">CEPH 节点安装</a>
<ul>
<li><a href="#设置hosts">设置hosts</a></li>
<li><a href="#创建部署-ceph-的用户">创建部署 CEPH 的用户</a></li>
<li><a href="#允许无密码-ssh-登录">允许无密码 SSH 登录</a></li>
<li><a href="#配置时钟同步">配置时钟同步</a></li>
<li><a href="#设置selinux">设置SELINUX</a></li>
<li><a href="#设置tty">设置TTY</a></li>
<li><a href="#安装yum-plugin-priorities">安装yum-plugin-priorities</a></li>
<li><a href="#加载rbd模块">加载rbd模块</a></li>
</ul></li>
</ul></li>
<li><a href="#创建集群">创建集群</a>
<ul>
<li><a href="#创建集群-1">创建集群</a></li>
<li><a href="#初始化osd">初始化OSD</a></li>
</ul></li>
<li><a href="#操作集群">操作集群</a>
<ul>
<li><a href="#集群扩容">集群扩容</a>
<ul>
<li><a href="#添加-osd">添加 OSD</a></li>
<li><a href="#添加-monitors">添加 MONITORS</a></li>
<li><a href="#添加-mds">添加 MDS</a></li>
<li><a href="#添加-rgw-例程">添加 RGW 例程</a></li>
</ul></li>
<li><a href="#操作数据">操作数据</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<p>本文主要记录在虚拟机中安装Ceph单节点集群的过程，其实多配置几个节点，也就是安装集群的过程。</p>

<p>Ceph中午文档：<a href="http://docs.ceph.org.cn/">http://docs.ceph.org.cn/</a></p>

<h1 id="集群规划">集群规划</h1>

<p>集群环境：</p>

<table>
<thead>
<tr>
<th>主机</th>
<th>IP</th>
<th>操作系统</th>
<th>软件</th>
<th>组件</th>
</tr>
</thead>

<tbody>
<tr>
<td>k8s-rke-node001</td>
<td>192.168.56.111</td>
<td>Centos7.7.1908</td>
<td>Ceph 14.2.4</td>
<td>ceph_deploy、OSD、MON</td>
</tr>

<tr>
<td>k8s-rke-node002</td>
<td>192.168.56.112</td>
<td>Centos7.7.1908</td>
<td>Ceph 14.2.4</td>
<td>OSD、MON</td>
</tr>

<tr>
<td>k8s-rke-node003</td>
<td>192.168.56.113</td>
<td>Centos7.7.1908</td>
<td>Ceph 14.2.4</td>
<td>OSD、MON</td>
</tr>
</tbody>
</table>

<p>安装用户：chenzj</p>

<h1 id="准备环境">准备环境</h1>

<h2 id="安装-ceph-部署工具">安装 CEPH 部署工具</h2>

<p>把 Ceph 仓库添加到 <code>ceph-deploy</code> 管理节点，然后安装 <code>ceph-deploy</code> 。</p>

<p>安装包管理工具：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum install -y yum-utils 
sudo yum-config-manager --add-repo https://dl.fedoraproject.org/pub/epel/7/x86_64/  
sudo yum install --nogpgcheck -y epel-release 
sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7 
sudo rm /etc/yum.repos.d/dl.fedoraproject.org*</code></pre></td></tr></table>
</div>
</div>
<p>配置yum源，注意：这里ceph使用的是nautilus版本。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">cat <span class="s">&lt;&lt; EOF &gt; ceph.repo
</span><span class="s">[Ceph-noarch]
</span><span class="s">name=Ceph noarch packages
</span><span class="s">baseurl=http://mirrors.163.com/ceph/rpm-nautilus/el7/noarch
</span><span class="s">enabled=1
</span><span class="s">gpgcheck=0
</span><span class="s">type=rpm-md
</span><span class="s">gpgkey=https://mirrors.163.com/ceph/keys/release.asc
</span><span class="s">priority=1
</span><span class="s">EOF</span>

sudo mv ceph.repo /etc/yum.repos.d/</code></pre></td></tr></table>
</div>
</div>
<p>设置环境变量，使ceph-deploy使用163源。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">export</span> <span class="nv">CEPH_DEPLOY_REPO_URL</span><span class="o">=</span>https://mirrors.163.com/ceph/rpm-nautilus/el7
<span class="nb">export</span> <span class="nv">CEPH_DEPLOY_GPG_URL</span><span class="o">=</span>http://mirrors.163.com/ceph/keys/release.asc</code></pre></td></tr></table>
</div>
</div>
<p>更新软件库并安装 <code>ceph-deploy</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum update <span class="o">&amp;&amp;</span> sudo yum install ceph-deploy</code></pre></td></tr></table>
</div>
</div>
<h2 id="ceph-节点安装">CEPH 节点安装</h2>

<p>你的管理节点必须能够通过 SSH 无密码地访问各 Ceph 节点。如果 <code>ceph-deploy</code> 以某个普通用户登录，那么这个用户必须有无密码使用 <code>sudo</code> 的权限。</p>

<h3 id="设置hosts">设置hosts</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="m">192</span>.168.56.111 k8s-rke-node001
<span class="m">192</span>.168.56.112 k8s-rke-node002
<span class="m">192</span>.168.56.113 k8s-rke-node003</code></pre></td></tr></table>
</div>
</div>
<h3 id="创建部署-ceph-的用户">创建部署 CEPH 的用户</h3>

<p><code>ceph-deploy</code> 工具必须以普通用户登录 Ceph 节点，且此用户拥有无密码使用 <code>sudo</code> 的权限，因为它需要在安装软件及配置文件的过程中，不必输入密码。</p>

<p>在各 Ceph 节点创建新用户并设置密码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">USER</span><span class="o">=</span>chenzj
useradd -G docker -d /home/<span class="nv">$USER</span> -m <span class="nv">$USER</span> 
<span class="nb">echo</span> <span class="nv">$USER</span><span class="p">|</span>passwd <span class="nv">$USER</span> --stdin &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span></code></pre></td></tr></table>
</div>
</div>
<p>确保各 Ceph 节点上新创建的用户都有 <code>sudo</code> 权限。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2"> ALL = (root) NOPASSWD:ALL&#34;</span> <span class="p">|</span> sudo tee /etc/sudoers.d/<span class="nv">$USER</span>
sudo chmod <span class="m">0440</span> /etc/sudoers.d/<span class="nv">$USER</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="允许无密码-ssh-登录">允许无密码 SSH 登录</h3>

<p>正因为 <code>ceph-deploy</code> 不支持输入密码，你必须在管理节点上生成 SSH 密钥并把其公钥分发到各 Ceph 节点。 <code>ceph-deploy</code> 会尝试给初始 monitors 生成 SSH 密钥对。</p>

<p>生成 SSH 密钥对，但不要用 <code>sudo</code> 或 <code>root</code> 用户。提示 “Enter passphrase” 时，直接回车，口令即为空：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">su - <span class="nv">$USER</span>
yes<span class="p">|</span>ssh-keygen -f ~/.ssh/id_rsa -t rsa -N <span class="s2">&#34;&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>把公钥拷贝到各 Ceph 节点</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ssh-copy-id <span class="nv">$USER</span>@k8s-rke-node001
ssh-copy-id <span class="nv">$USER</span>@k8s-rke-node002
ssh-copy-id <span class="nv">$USER</span>@k8s-rke-node003</code></pre></td></tr></table>
</div>
</div>
<p>修改 <code>ceph-deploy</code> 管理节点上的 <code>~/.ssh/config</code> 文件，这样 <code>ceph-deploy</code> 就能用你所建的用户名登录 Ceph 节点了，而无需每次执行 <code>ceph-deploy</code> 都要指定 <code>--username</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">cat <span class="s">&lt;&lt; EOF &gt;&gt; ~/.ssh/config
</span><span class="s">Host      	k8s-rke-node001
</span><span class="s">	Hostname  k8s-rke-node001
</span><span class="s">	User      $USER
</span><span class="s">
</span><span class="s">Host      	k8s-rke-node002
</span><span class="s">	Hostname  k8s-rke-node002
</span><span class="s">	User      $USER
</span><span class="s">
</span><span class="s">Host      	k8s-rke-node003
</span><span class="s">	Hostname  k8s-rke-node003
</span><span class="s">	User      $USER
</span><span class="s">EOF</span>

chmod <span class="m">644</span> ~/.ssh/config</code></pre></td></tr></table>
</div>
</div>
<h3 id="配置时钟同步">配置时钟同步</h3>

<h3 id="设置selinux">设置SELINUX</h3>

<p>在 CentOS 和 RHEL 上， SELinux 默认为 <code>Enforcing</code> 开启状态。为简化安装，我们建议把 SELinux 设置为 <code>Permissive</code> 或者完全禁用，也就是在加固系统配置前先确保集群的安装、配置没问题。用下列命令把 SELinux 设置为 <code>Permissive</code> ：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo setenforce <span class="m">0</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="设置tty">设置TTY</h3>

<p>在 CentOS 和 RHEL 上执行 <code>ceph-deploy</code> 命令时可能会报错。如果你的 Ceph 节点默认设置了 <code>requiretty</code> ，执行 <code>sudo visudo</code> 禁用它，并找到 <code>Defaults requiretty</code> 选项，把它改为 <code>Defaults:ceph !requiretty</code> 或者直接注释掉，这样 <code>ceph-deploy</code> 就可以用之前创建的用户（<a href="http://docs.ceph.org.cn/start/quick-start-preflight/#id3">创建部署 Ceph 的用户</a> ）连接了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sed -i <span class="s1">&#39;s/Defaults *requiretty/#Defaults requiretty/g&#39;</span> /etc/sudoers
sed -i <span class="s1">&#39;s/Defaults *!visiblepw/Defaults   visiblepw/g&#39;</span> /etc/sudoers</code></pre></td></tr></table>
</div>
</div>
<h3 id="安装yum-plugin-priorities">安装yum-plugin-priorities</h3>

<p>确保你的包管理器安装了优先级/首选项包且已启用。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum install yum-plugin-priorities -y</code></pre></td></tr></table>
</div>
</div>
<h3 id="加载rbd模块">加载rbd模块</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">sudo modprobe rbd</pre></td></tr></table>
</div>
</div>
<h1 id="创建集群">创建集群</h1>

<p>先在ceph-deploy管理节点上创建一个目录，用于保存 <code>ceph-deploy</code> 生成的配置文件和密钥对。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 创建集群配置目录</span>
mkdir ceph-cluster <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ceph-cluster</code></pre></td></tr></table>
</div>
</div>
<p><code>ceph-deploy</code> 会把文件输出到当前目录，所以请确保在此目录下执行 <code>ceph-deploy</code> 。</p>

<h2 id="创建集群-1">创建集群</h2>

<p>在管理节点上，进入刚创建的放置配置文件的目录，用 <code>ceph-deploy</code> 执行如下步骤，安装规划在k8s-rke-node001节点初始化Monitor。</p>

<p>1、创建集群</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph-deploy new k8s-rke-node001 <span class="se">\
</span><span class="se"></span>  --public-network <span class="m">192</span>.168.56.0/24 <span class="se">\
</span><span class="se"></span>  --cluster-network <span class="m">192</span>.168.56.0/24 </code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>注意：public-network要和当前ip的网段保持对应。</p>
</blockquote>

<p>2、在当前目录下用 <code>ls</code> 和 <code>cat</code> 检查 <code>ceph-deploy</code> 的输出，应该有一个 Ceph 配置文件、一个 monitor 密钥环和一个日志文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">-rw-r--r-- <span class="m">1</span> root root    <span class="m">291</span> 9月  <span class="m">17</span> <span class="m">22</span>:15 ceph.conf
-rw-r--r-- <span class="m">1</span> root root <span class="m">212100</span> 9月  <span class="m">17</span> <span class="m">22</span>:16 ceph-deploy-ceph.log
-rw------- <span class="m">1</span> root root     <span class="m">73</span> 9月  <span class="m">16</span> <span class="m">09</span>:40 ceph.mon.keyring</code></pre></td></tr></table>
</div>
</div>
<p>3、如果出现异常：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&#34;/usr/bin/ceph-deploy&#34;</span>, line <span class="m">18</span>, in &lt;module&gt;
    from ceph_deploy.cli import main
  File <span class="s2">&#34;/usr/lib/python2.7/site-packages/ceph_deploy/cli.py&#34;</span>, line <span class="m">1</span>, in &lt;module&gt;
    import pkg_resources
ImportError: No module named pkg_resources</code></pre></td></tr></table>
</div>
</div>
<p>安装相关依赖即可：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum install python-pkg-resources python-setuptools -y</code></pre></td></tr></table>
</div>
</div>
<p>4、把 Ceph 配置文件里的默认副本数从 <code>3</code> 改成 <code>2</code> ，这样只有两个 OSD 也可以达到 <code>active + clean</code> 状态。把下面这行加入 <code>[global]</code> 段：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></pre></td>
<td class="lntd">
<pre class="chroma">echo &#34;
osd_pool_default_size =2

[mon]
mon_allow_pool_delete = true
mon_max_pg_per_osd = 1024
#时钟同步
mon_clock_drift_allowed = 2
mon_clock_drift_warn_backoff = 30
&#34; &gt;&gt; ceph.conf</pre></td></tr></table>
</div>
</div>
<p>5、通过 ceph-deploy 在各个节点安装 ceph：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph-deploy install k8s-rke-node001 k8s-rke-node002 k8s-rke-node003</code></pre></td></tr></table>
</div>
</div>
<p>6、此过程需要等待一段时间，因为 ceph-deploy 会 SSH 登录到各 node 上去，依次执行安装 ceph 依赖的组件包。</p>

<p>如果下载太慢，可以设置镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo rpm --import http://mirrors.163.com/ceph/keys/release.asc
ceph-deploy install --repo-url http://mirrors.163.com/ceph/rpm-nautilus k8s-rke-node001</code></pre></td></tr></table>
</div>
</div>
<p>如果还是太慢，则在<strong>每个节点配置ceph的yum源</strong>，然后通过yum安装：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum -y install ceph ceph-radosgw</code></pre></td></tr></table>
</div>
</div>
<p>7、安装成功之后，检查每个节点的ceph版本是否一致：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">sudo ceph --version
ceph version 14.2.4 (75f4de193b3ea58512f204623e6c5a16e6c1e1ba) nautilus (stable)</pre></td></tr></table>
</div>
</div>
<p>8、配置初始 monitor(s)、并收集所有密钥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy mon create-initial</pre></td></tr></table>
</div>
</div>
<p>完成上述操作后，当前目录里应该会出现这些密钥：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph.client.admin.keyring
ceph.bootstrap-mgr.keyring
ceph.bootstrap-osd.keyring
ceph.bootstrap-mds.keyring
ceph.bootstrap-rgw.keyring
ceph.bootstrap-rbd.keyring
ceph.bootstrap-rbd-mirror.keyring</pre></td></tr></table>
</div>
</div>
<p>如果出现下面异常：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">[ceph_deploy.mon][ERROR ] Some monitors have still not reached quorum:
[ceph_deploy.mon][ERROR ] k8s-rke-node001</pre></td></tr></table>
</div>
</div>
<p>可能原因：</p>

<ul>
<li>ceph版本不一致</li>
<li>hostname没设置正确</li>
</ul>

<p>查看仲裁信息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph quorum_status --format json-pretty</pre></td></tr></table>
</div>
</div>
<h2 id="初始化osd">初始化OSD</h2>

<p>1、添加两个 OSD 。为了快速地安装，这篇快速入门把目录而非整个硬盘用于 OSD 守护进程。如何为 OSD 及其日志使用独立硬盘或分区，请参考 <a href="http://docs.ceph.org.cn/rados/deployment/ceph-deploy-osd">ceph-deploy osd</a> 。登录到 Ceph 节点、并给 OSD 守护进程创建一个目录。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ssh k8s-rke-node001 <span class="s2">&#34;sudo mkdir -p /data/ceph/osd&#34;</span>
ssh k8s-rke-node002 <span class="s2">&#34;sudo mkdir -p /data/ceph/osd&#34;</span>
ssh k8s-rke-node003 <span class="s2">&#34;sudo mkdir -p /data/ceph/osd&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>然后，从管理节点执行 <code>ceph-deploy</code> 来准备 OSD 。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy osd create --data /data/ceph/osd k8s-rke-node001
ceph-deploy osd create --data /data/ceph/osd k8s-rke-node002
ceph-deploy osd create --data /data/ceph/osd k8s-rke-node003</pre></td></tr></table>
</div>
</div>
<p>查看创建的osd：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy osd list k8s-rke-node001
ceph-deploy osd list k8s-rke-node002
ceph-deploy osd list k8s-rke-node003</pre></td></tr></table>
</div>
</div>
<p>如果是想用磁盘，则必须先格式化：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo mkfs /dev/sdb</code></pre></td></tr></table>
</div>
</div>
<p>列出节点所有磁盘信息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph-deploy disk list k8s-rke-node001
ceph-deploy disk list k8s-rke-node002
ceph-deploy disk list k8s-rke-node003</code></pre></td></tr></table>
</div>
</div>
<p>清除磁盘分区和内容：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy disk zap k8s-rke-node001 /dev/sdb
ceph-deploy disk zap k8s-rke-node002 /dev/sdb
ceph-deploy disk zap k8s-rke-node003 /dev/sdb</pre></td></tr></table>
</div>
</div>
<p>2、用 <code>ceph-deploy</code> 把配置文件和 admin 密钥拷贝到管理节点和 Ceph 节点，这样你每次执行 Ceph 命令行时就无需指定 monitor 地址和 <code>ceph.client.admin.keyring</code> 了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph-deploy admin k8s-rke-node001 k8s-rke-node002 k8s-rke-node003</code></pre></td></tr></table>
</div>
</div>
<p>3、确保你对 <code>ceph.client.admin.keyring</code> 有正确的操作权限。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo chmod +r /etc/ceph/ceph.client.admin.keyring</code></pre></td></tr></table>
</div>
</div>
<p>4、检查集群的健康状况。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph health</pre></td></tr></table>
</div>
</div>
<p>等 peering 完成后，集群应该达到 <code>active + clean</code> 状态。</p>

<h1 id="操作集群">操作集群</h1>

<p>用 <code>ceph-deploy</code> 部署完成后它会自动启动集群。Ceph 集群部署完成后，你可以尝试一下管理功能、 <code>rados</code> 对象存储命令，之后可以继续快速入门手册，了解 Ceph 块设备、 Ceph 文件系统和 Ceph 对象网关。</p>

<h2 id="集群扩容">集群扩容</h2>

<p>一个基本的集群启动并开始运行后，下一步就是扩展集群。在 k8s-rke-node004 上添加一个 OSD 守护进程和一个元数据服务器。然后分别在 k8s-rke-node002 和 k8s-rke-node003 上添加 Ceph Monitor ，以形成 Monitors 的法定人数。</p>

<h3 id="添加-osd">添加 OSD</h3>

<p>在 k8s-rke-node004 上添加一个 OSD：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ssh k8s-rke-node004 <span class="s2">&#34;sudo mkdir -p /data/ceph/osd&#34;</span>
ceph-deploy osd create --data /data/ceph/osd k8s-rke-node004</code></pre></td></tr></table>
</div>
</div>
<p>一旦你新加了 OSD ， Ceph 集群就开始重均衡，把归置组迁移到新 OSD 。可以用下面的 <code>ceph</code> 命令观察此过程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph -w</pre></td></tr></table>
</div>
</div>
<p>你应该能看到归置组状态从 <code>active + clean</code> 变为 <code>active</code> ，还有一些降级的对象；迁移完成后又会回到 <code>active + clean</code> 状态（ Control-C 退出）。</p>

<h3 id="添加-monitors">添加 MONITORS</h3>

<p>Ceph 存储集群需要至少一个 Monitor 才能运行。为达到高可用，典型的 Ceph 存储集群会运行多个 Monitors，这样在单个 Monitor 失败时不会影响 Ceph 存储集群的可用性。Ceph 使用 PASOX 算法，此算法要求有多半 monitors（即 1 、 2:3 、 3:4 、 3:5 、 4:6 等 ）形成法定人数。</p>

<p>k8s-rke-node002 和 k8s-rke-node003 上添加 Ceph Monitor</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy mon add k8s-rke-node002
ceph-deploy mon add k8s-rke-node003</pre></td></tr></table>
</div>
</div>
<p>新增 Monitor 后，Ceph 会自动开始同步并形成法定人数。你可以用下面的命令检查法定人数状态：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph quorum_status --format json-pretty</pre></td></tr></table>
</div>
</div>
<ul>
<li>请确保ntp时钟同步</li>
</ul>

<h3 id="添加-mds">添加 MDS</h3>

<p>至少需要一个元数据服务器才能使用 CephFS ，执行下列命令创建元数据服务器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy mds create k8s-rke-node001</pre></td></tr></table>
</div>
</div>
<blockquote>
<p>注意：</p>

<p>当前生产环境下的 Ceph 只能运行一个元数据服务器。</p>
</blockquote>

<h3 id="添加-rgw-例程">添加 RGW 例程</h3>

<p>要使用 Ceph 的 <a href="http://docs.ceph.org.cn/glossary/#term-34"><em>Ceph 对象网关</em></a>组件，必须部署 <a href="http://docs.ceph.org.cn/glossary/#term-rgw"><em>RGW</em></a> 例程。用下列方法创建新 RGW 例程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">ceph-deploy rgw create k8s-rke-node001</pre></td></tr></table>
</div>
</div>
<p><a href="http://docs.ceph.org.cn/glossary/#term-rgw"><em>RGW</em></a> 例程默认会监听 7480 端口，可以更改该节点 ceph.conf 内与 <a href="http://docs.ceph.org.cn/glossary/#term-rgw"><em>RGW</em></a> 相关的配置，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>client<span class="o">]</span>
rgw <span class="nv">frontends</span> <span class="o">=</span> civetweb <span class="nv">port</span><span class="o">=</span><span class="m">80</span></code></pre></td></tr></table>
</div>
</div>
<p>浏览器访问：<a href="http://192.168.56.111:7480">http://192.168.56.111:7480</a></p>

<h2 id="操作数据">操作数据</h2>

<p>要把对象存入 Ceph 存储集群，客户端必须做到：</p>

<ol>
<li>指定<strong>对象名</strong></li>
<li>指定<strong>存储池</strong></li>
</ol>

<p>Ceph 客户端检出最新集群运行图，用 CRUSH 算法计算出如何把对象映射到<strong>归置组</strong>，然后动态地计算如何把归置组分配到 OSD 。要定位对象，只需要对象名和存储池名字即可，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph osd map <span class="o">{</span>poolname<span class="o">}</span> <span class="o">{</span>object-name<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>作为练习，我们先创建一个对象，用 <code>rados put</code> 命令加上对象名、一个有数据的测试文件路径、并指定存储池。例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">echo</span> <span class="o">{</span>Test-data<span class="o">}</span> &gt; testfile.txt
rados put <span class="o">{</span>object-name<span class="o">}</span> <span class="o">{</span>file-path<span class="o">}</span> --pool<span class="o">=</span>data
rados put test-object-1 testfile.txt --pool<span class="o">=</span>data</code></pre></td></tr></table>
</div>
</div>
<p>为确认 Ceph 存储集群存储了此对象，可执行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">rados -p data ls</code></pre></td></tr></table>
</div>
</div>
<p>现在，定位对象：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">ceph osd map <span class="o">{</span>pool-name<span class="o">}</span> <span class="o">{</span>object-name<span class="o">}</span>
ceph osd map data test-object-1</code></pre></td></tr></table>
</div>
</div>
<p>Ceph 应该会输出对象的位置，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">osdmap e537 pool <span class="s1">&#39;data&#39;</span> <span class="o">(</span><span class="m">0</span><span class="o">)</span> object <span class="s1">&#39;test-object-1&#39;</span> -&gt; pg <span class="m">0</span>.d1743484 <span class="o">(</span><span class="m">0</span>.4<span class="o">)</span> -&gt; up <span class="o">[</span><span class="m">1</span>,0<span class="o">]</span> acting <span class="o">[</span><span class="m">1</span>,0<span class="o">]</span></code></pre></td></tr></table>
</div>
</div>
<p>用<code>rados rm</code> 命令可删除此测试对象，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">rados rm test-object-1 --pool<span class="o">=</span>data</code></pre></td></tr></table>
</div>
</div>
<p>随着集群的运行，对象位置可能会动态改变。 Ceph 有动态均衡机制，无需手动干预即可完成。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">JavaChen</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2019-11-24
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechatpay.jpg">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay.jpg">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/ceph/">ceph</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2019/11/28/some-commads-of-docker/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Docker常用命令</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2019/11/22/install-file-fdw-for-postgresql/">
            <span class="next-text nav-default">PostgreSQL安装并测试file_fdw</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="javachen/javachen.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:junecloud@163.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/javachen" class="iconfont icon-github" title="github"></a>
      <a href="http://weibo.com/chenzhijun" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://space.bilibili.com/287563020/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://blog.javachen.space/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2009 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">JavaChen</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.20b54c22.min.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?7eaf37274cf8796df56903a88389e82f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>

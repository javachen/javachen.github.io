<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Struts2 - JavaChen Blog - Ramblings of a coder</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="JavaChen" /><meta name="description" content="Struts2 是一个基于 MVC 设计模式的 Web 应用框架，它本质上相当于一个 Servlet，在 MVC 设计模式中，Struts2 作为控制器来建立模型与视图的数据交互。Struts2 是 Struts 的下一代产品，是在 struts 和 WebWork 的技术基础上进行了合并的全新的 Struts2 框架。" /><meta name="keywords" content="Java, Hadoop, Docker" />


<meta name="baidu-site-verification" content="OMsbiDfo1G" />



<meta name="generator" content="Hugo 0.58.3 with theme even" />


<link rel="canonical" href="https://javachen.github.io/2019/07/01/struts2/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.5d87ca31.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="Struts2" />
<meta property="og:description" content="Struts2 是一个基于 MVC 设计模式的 Web 应用框架，它本质上相当于一个 Servlet，在 MVC 设计模式中，Struts2 作为控制器来建立模型与视图的数据交互。Struts2 是 Struts 的下一代产品，是在 struts 和 WebWork 的技术基础上进行了合并的全新的 Struts2 框架。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://javachen.github.io/2019/07/01/struts2/" />
<meta property="article:published_time" content="2019-07-01T08:00:00+08:00" />
<meta property="article:modified_time" content="2019-07-01T08:00:00+08:00" />
<meta itemprop="name" content="Struts2">
<meta itemprop="description" content="Struts2 是一个基于 MVC 设计模式的 Web 应用框架，它本质上相当于一个 Servlet，在 MVC 设计模式中，Struts2 作为控制器来建立模型与视图的数据交互。Struts2 是 Struts 的下一代产品，是在 struts 和 WebWork 的技术基础上进行了合并的全新的 Struts2 框架。">


<meta itemprop="datePublished" content="2019-07-01T08:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2019-07-01T08:00:00&#43;08:00" />
<meta itemprop="wordCount" content="11479">



<meta itemprop="keywords" content="struts2," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Struts2"/>
<meta name="twitter:description" content="Struts2 是一个基于 MVC 设计模式的 Web 应用框架，它本质上相当于一个 Servlet，在 MVC 设计模式中，Struts2 作为控制器来建立模型与视图的数据交互。Struts2 是 Struts 的下一代产品，是在 struts 和 WebWork 的技术基础上进行了合并的全新的 Struts2 框架。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">JavaChen Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">JavaChen Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Struts2</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-07-01 </span>
        <div class="post-category">
            <a href="/categories/java/"> java </a>
            </div>
          <span class="more-meta"> 约 11479 字 </span>
          <span class="more-meta"> 预计阅读 23 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#struts2概述">Struts2概述</a></li>
<li><a href="#struts2-mvc架构">Struts2 MVC架构</a></li>
<li><a href="#struts2原理">Struts2原理</a></li>
<li><a href="#struts2入门例子">Struts2入门例子</a>
<ul>
<li><a href="#1-创建maven项目">1、创建maven项目</a></li>
<li><a href="#2-创建index-jsp">2、创建index.jsp</a></li>
<li><a href="#3-添加-struts2">3、添加  Struts2</a></li>
<li><a href="#4-添加logging">4、添加Logging</a></li>
<li><a href="#5-添加struts-2过滤器">5、添加Struts 2过滤器</a></li>
<li><a href="#7-构建并运行程序">7、构建并运行程序</a></li>
<li><a href="#8-创建-model-类">8、创建 Model 类</a></li>
<li><a href="#9-创建-action-类">9、创建 Action 类</a></li>
<li><a href="#10-创建视图">10、创建视图</a></li>
<li><a href="#11-修改-struts-xml">11、修改 struts.xml</a></li>
<li><a href="#12-修改-index-jsp">12、修改 index.jsp</a></li>
<li><a href="#13-再次运行应用">13、再次运行应用</a></li>
<li><a href="#14-运行原理">14、运行原理</a></li>
</ul></li>
<li><a href="#struts2配置文件">Struts2配置文件</a>
<ul>
<li><a href="#web-xml">web.xml</a></li>
<li><a href="#struts-xml">struts.xml</a></li>
<li><a href="#struts-config-xml">struts-config.xml</a></li>
<li><a href="#struts-properties">struts.properties</a></li>
<li><a href="#default-properties"><strong>default.properties</strong></a></li>
</ul></li>
<li><a href="#struts2-action">Struts2 Action</a>
<ul>
<li><a href="#创建action">创建Action</a></li>
<li><a href="#多个action方法">多个Action方法</a></li>
<li><a href="#动态方法调用">动态方法调用</a></li>
<li><a href="#默认的action">默认的Action</a></li>
<li><a href="#通配符映射">通配符映射</a></li>
<li><a href="#修改struts后缀">修改struts后缀</a></li>
</ul></li>
<li><a href="#struts2-result">Struts2 Result</a></li>
<li><a href="#struts2-拦截器">Struts2 <strong>拦截器</strong></a>
<ul>
<li><a href="#使用拦截器">使用拦截器</a></li>
<li><a href="#创建自定义拦截器">创建自定义拦截器</a></li>
<li><a href="#注册拦截器">注册拦截器</a></li>
<li><a href="#引用拦截器">引用拦截器</a></li>
<li><a href="#拦截器栈">拦截器栈</a></li>
</ul></li>
<li><a href="#struts2面试">Struts2面试</a>
<ul>
<li><a href="#拦截器和过滤器的区别"><strong>拦截器和过滤器的区别</strong></a></li>
<li><a href="#struts1于struts2的比较"><strong>struts1于struts2的比较</strong></a></li>
<li><a href="#struts2如何访问httpservletrequest-httpsession-servletcontext三个域对象">struts2如何访问HttpServletRequest、HttpSession、ServletContext三个域对象？</a></li>
<li><a href="#struts2如何对指定的方法进行验证"><strong>struts2如何对指定的方法进行验证？</strong></a></li>
<li><a href="#struts2默认能解决get和post提交方式的乱码问题吗"><strong>struts2默认能解决get和post提交方式的乱码问题吗？</strong></a></li>
<li><a href="#拦截器的生命周期与工作过程"><strong>拦截器的生命周期与工作过程？</strong></a></li>
</ul></li>
<li><a href="#参考文章">参考文章</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h1 id="struts2概述">Struts2概述</h1>

<p>​Struts2 是一个基于 MVC 设计模式的 Web 应用框架，它本质上相当于一个 Servlet，在 MVC 设计模式中，Struts2 作为控制器来建立模型与视图的数据交互。Struts2 是 Struts 的下一代产品，是在 struts 和 WebWork 的技术基础上进行了合并的全新的 Struts2 框架。</p>

<p>​Struts2 以 WebWork 为核心，采用拦截器的机制来处理用户的请求，这样的设计也使得业务逻辑控制器能够与 Servlet API 完全脱离开。</p>

<p><img src="/images/struts2-1.png" alt="img" /></p>

<p>​使用Struts2之前必须有一定的J2EE技术的储备，包括：</p>

<ul>
<li><a href="http://docs.oracle.com/javase/tutorial/index.html">熟悉Java</a></li>
<li><a href="https://docs.oracle.com/javaee/7/tutorial/">熟悉Java EE</a></li>
<li><a href="http://www.ietf.org/rfc/rfc2616.txt?number=2616">HTTP</a>、<a href="http://www.w3.org/MarkUp/">HTML</a></li>
<li>HTTP Request/Response</li>
<li>Java语言和应用框架：面向对象编程</li>
<li><a href="https://www.cnblogs.com/hopefu/p/4709777.html">反射和内省</a></li>
<li><a href="http://docs.oracle.com/javase/tutorial/essential/environment/properties.html">Properties</a>和<a href="http://docs.oracle.com/javase/tutorial/i18n/resbundle/concept.html">ResourceBundles</a></li>
<li>多线程</li>
<li>JavaScript、AJAX 和 SOAP</li>
<li><a href="https://docs.oracle.com/javaee/6/tutorial/doc/bnafd.html">Servlets</a>、Filters 和 Web Containers</li>
<li>Web应用

<ul>
<li><a href="http://maven.apache.org/">Maven</a></li>
<li>Tomcat</li>
<li>Jetty</li>
</ul></li>
<li>Sessions</li>
<li><a href="https://docs.oracle.com/javaee/6/tutorial/doc/gijrp.html">Security</a>  <a href="http://shiro.apache.org/">Apache Shiro</a> 或者 <a href="http://www.springframework.org/spring-security/">Spring Security</a></li>
<li>JavaServer Pages, <a href="http://www.oracle.com/technetwork/java/javaee/jsp/index.html">JSP</a> Tag Libraries, and JavaServer Faces

<ul>
<li><a href="http://www.freemarker.org/">Freemarker</a></li>
<li><a href="http://www.lowagie.com/iText/">iText (PDF)</a></li>
<li><a href="http://jaspersoft.com/">JasperReports</a></li>
<li><a href="http://velocity.apache.org/">Velocity</a></li>
<li><a href="http://www.w3.org/TR/xslt">XSLT</a></li>
</ul></li>
<li>XML</li>
<li>MVC</li>
<li>业务逻辑框架

<ul>
<li><a href="http://springframework.org/">Spring</a></li>
<li><a href="http://code.google.com/p/google-guice/‎">Google Guice</a></li>
<li><a href="http://commons.apache.org/chain/">Commons Chain of Responsiblity</a></li>
</ul></li>
<li>数据访问框架

<ul>
<li><a href="http://cayenne.apache.org/">Apache Cayenne</a></li>
<li><a href="http://docs.oracle.com/javaee/5/tutorial/doc/bnblr.html">Enterprise Java Beans</a></li>
<li><a href="http://www.hibernate.org/">Hibernate</a></li>
<li><a href="http://code.google.com/p/mybatis">myBATIS</a></li>
</ul></li>
</ul>

<h1 id="struts2-mvc架构">Struts2 MVC架构</h1>

<p>​模型（Model）、视图（View）、控制器（Controller），通常简称MVC，是一种开发web应用程序的软件设计模式。</p>

<p>​MVC普及的原因在于它区分了应用程序的逻辑层和用户界面层，并支持开发关注点的分离。在MVC模式下，控制器接收了所有来自应用程序的请求后，调用模型去准备视图所需要的数据，然后视图使用由控制器提供的数据最终生成一个可视的响应。MVC的抽象概念可通过以下图形进行表述：</p>

<p><img src="https://7n.w3cschool.cn/attachments/tuploads/struts_2/struts-mvc.jpg" alt="Struts MVC" /></p>

<p>该软件设计模式由以下三部分组成:　　</p>

<ul>
<li><strong>模型</strong>：模型主要负责管理应用程序的数据，它通过响应视图的请求和控制器的指令来更新自身的数据。</li>
<li><strong>视图</strong>：通过控制器的指令触发所展现的一种特殊的数据格式。它们是基于像JSP、ASP、PHP之类模板系统的脚本，较易与AJAX技术进行整合。</li>
<li><strong>控制器</strong>：控制器负责响应用户输入并执行数据模型对象的交互。控制器在接收、确认输入后执行修改数据模型状态的业务操作。</li>
</ul>

<h1 id="struts2原理">Struts2原理</h1>

<p>Struts2运行流程：</p>

<ul>
<li>1、浏览器发送一个请求</li>
<li>2、该请求被web.xml中配置的StrutsPrepareAndExecuteFilter过滤器拦截，根据URL去配置文件中查找对应的ActionMapping</li>
<li>3、ActionMapping根据namespae、name、method创建一个ActionProxy</li>
<li>4、ActionMapping找Result，ActionProxy创建一个ActionInvocation的实例，如果Result不为空，则调用ActionInvocation返回相应的结果，否则，ActionProxy直接运行。</li>
</ul>

<h1 id="struts2入门例子">Struts2入门例子</h1>

<h2 id="1-创建maven项目">1、创建maven项目</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mvn archetype:generate -DgroupId<span class="o">=</span>com.javachen -DartifactId<span class="o">=</span>helloworld 
 -DarchetypeArtifactId<span class="o">=</span>maven-archetype-webapp -DinteractiveMode<span class="o">=</span>false</code></pre></td></tr></table>
</div>
</div>
<p>pom.xml build节点如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;finalName&gt;</span>helloworld<span class="nt">&lt;/finalName&gt;</span>
<span class="nt">&lt;/build&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>添加jetty插件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;build&gt;</span>
  <span class="nt">&lt;finalName&gt;</span>helloworld<span class="nt">&lt;/finalName&gt;</span>
  
  <span class="nt">&lt;plugins&gt;</span>
    <span class="nt">&lt;plugin&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.eclipse.jetty<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>jetty-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${jetty-plugin.version}<span class="nt">&lt;/version&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;webApp&gt;</span>
          <span class="nt">&lt;contextPath&gt;</span>/${project.artifactId}<span class="nt">&lt;/contextPath&gt;</span>
        <span class="nt">&lt;/webApp&gt;</span>
        <span class="nt">&lt;stopKey&gt;</span>CTRL+C<span class="nt">&lt;/stopKey&gt;</span>
        <span class="nt">&lt;stopPort&gt;</span>8999<span class="nt">&lt;/stopPort&gt;</span>
        <span class="nt">&lt;scanIntervalSeconds&gt;</span>10<span class="nt">&lt;/scanIntervalSeconds&gt;</span>
        <span class="nt">&lt;scanTargets&gt;</span>
          <span class="nt">&lt;scanTarget&gt;</span>src/main/webapp/WEB-INF/web.xml<span class="nt">&lt;/scanTarget&gt;</span>
        <span class="nt">&lt;/scanTargets&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
  <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>在 properties 节点添加 jetty-plugin.version 节点设置版本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;jetty-plugin.version&gt;</span>9.4.11.v20180605<span class="nt">&lt;/jetty-plugin.version&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>可以使用<code>mvn jetty:run</code>运行jetty插件，默认端口为8080。</p>

<h2 id="2-创建index-jsp">2、创建index.jsp</h2>

<p>在src/main/webapp目录创建index.jsp：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></pre></td>
<td class="lntd">
<pre class="chroma">&lt;!DOCTYPE html&gt;
&lt;%@ page language=&#34;java&#34; contentType=&#34;text/html; charset=UTF-8&#34; pageEncoding=&#34;UTF-8&#34; %&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&#34;UTF-8&#34;&gt;
    &lt;title&gt;Basic Struts 2 Application - Welcome&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Welcome To Struts 2!&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></td></tr></table>
</div>
</div>
<p>运行<code>mvn jetty:run</code>，打开浏览器，访问 <a href="http://localhost:8080/helloworld/index.jsp">http://localhost:8080/helloworld/index.jsp</a> 将看到：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">Welcome To Struts 2!</pre></td></tr></table>
</div>
</div>
<h2 id="3-添加-struts2">3、添加  Struts2</h2>

<p>pom.xml添加：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.struts<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>struts2-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${struts2.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>在 properties 节点添加 struts2.version 节点设置版本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;struts2.version&gt;</span>2.5.20<span class="nt">&lt;/struts2.version&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="4-添加logging">4、添加Logging</h2>

<p>在src/main/resources目录添加log4j2.xml：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;Configuration&gt;</span>
    <span class="nt">&lt;Appenders&gt;</span>
        <span class="nt">&lt;Console</span> <span class="na">name=</span><span class="s">&#34;STDOUT&#34;</span> <span class="na">target=</span><span class="s">&#34;SYSTEM_OUT&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">&#34;%d %-5p [%t] %C{2} (%F:%L) - %m%n&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Console&gt;</span>
    <span class="nt">&lt;/Appenders&gt;</span>
    <span class="nt">&lt;Loggers&gt;</span>
        <span class="nt">&lt;Logger</span> <span class="na">name=</span><span class="s">&#34;com.opensymphony.xwork2&#34;</span> <span class="na">level=</span><span class="s">&#34;debug&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Logger</span> <span class="na">name=</span><span class="s">&#34;org.apache.struts2&#34;</span> <span class="na">level=</span><span class="s">&#34;debug&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Root</span> <span class="na">level=</span><span class="s">&#34;warn&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;STDOUT&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Root&gt;</span>
    <span class="nt">&lt;/Loggers&gt;</span>
<span class="nt">&lt;/Configuration&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p><strong>pom.xml</strong>添加log4j2依赖：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>log4j-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${log4j2.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>log4j-api<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${log4j2.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>在 properties 节点添加 log4j2.version 节点设置版本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;log4j2.version&gt;</span>2.10.0<span class="nt">&lt;/log4j2.version&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>完整的pom如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;project</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
  <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.javachen<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>helloworld<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>helloworld Maven Webapp<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;url&gt;</span>http://maven.apache.org<span class="nt">&lt;/url&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.reporting.outputEncoding&gt;</span>
        <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>

        <span class="nt">&lt;struts2.version&gt;</span>2.5.20<span class="nt">&lt;/struts2.version&gt;</span>
        <span class="nt">&lt;log4j2.version&gt;</span>2.10.0<span class="nt">&lt;/log4j2.version&gt;</span>

        <span class="nt">&lt;jetty-plugin.version&gt;</span>9.4.11.v20180605<span class="nt">&lt;/jetty-plugin.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.struts<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>struts2-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${struts2.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>log4j-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${log4j2.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>log4j-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${log4j2.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.8.1<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;finalName&gt;</span>helloworld<span class="nt">&lt;/finalName&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.eclipse.jetty<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>jetty-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>${jetty-plugin.version}<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;webApp&gt;</span>
                        <span class="nt">&lt;contextPath&gt;</span>/${project.artifactId}<span class="nt">&lt;/contextPath&gt;</span>
                    <span class="nt">&lt;/webApp&gt;</span>
                    <span class="nt">&lt;stopKey&gt;</span>CTRL+C<span class="nt">&lt;/stopKey&gt;</span>
                    <span class="nt">&lt;stopPort&gt;</span>8999<span class="nt">&lt;/stopPort&gt;</span>
                    <span class="nt">&lt;scanIntervalSeconds&gt;</span>10<span class="nt">&lt;/scanIntervalSeconds&gt;</span>
                    <span class="nt">&lt;scanTargets&gt;</span>
                        <span class="nt">&lt;scanTarget&gt;</span>src/main/webapp/WEB-INF/web.xml<span class="nt">&lt;/scanTarget&gt;</span>
                    <span class="nt">&lt;/scanTargets&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>这里也可以使用 <code>dependencyManagement</code> 来管理 struts2 和 log4j2 的依赖：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;properties&gt;</span>
    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.reporting.outputEncoding&gt;</span>
    <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>

    <span class="nt">&lt;struts2.version&gt;</span>2.5.20<span class="nt">&lt;/struts2.version&gt;</span>
    <span class="nt">&lt;log4j2.version&gt;</span>2.10.0<span class="nt">&lt;/log4j2.version&gt;</span>
  
  <span class="nt">&lt;jetty-plugin.version&gt;</span>9.4.11.v20180605<span class="nt">&lt;/jetty-plugin.version&gt;</span>
<span class="nt">&lt;/properties&gt;</span>

<span class="nt">&lt;dependencyManagement&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.struts<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>struts2-bom<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${struts2.version}<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>log4j-bom<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${log4j2.version}<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/dependencyManagement&gt;</span>

<span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- Struts 2 --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.struts<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>struts2-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.logging.log4j<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>log4j-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="5-添加struts-2过滤器">5、添加Struts 2过滤器</h2>

<p>修改 web.xml ：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">id=</span><span class="s">&#34;WebApp_ID&#34;</span> <span class="na">version=</span><span class="s">&#34;2.4&#34;</span>
<span class="na">xmlns=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee&#34;</span>
<span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;display-name&gt;</span>Hello World<span class="nt">&lt;/display-name&gt;</span>
    
    <span class="nt">&lt;welcome-file-list&gt;</span>
        <span class="nt">&lt;welcome-file&gt;</span>index<span class="nt">&lt;/welcome-file&gt;</span>
    <span class="nt">&lt;/welcome-file-list&gt;</span>

    <span class="nt">&lt;filter&gt;</span>
        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
        <span class="nt">&lt;filter-class&gt;</span>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter<span class="nt">&lt;/filter-class&gt;</span>
    <span class="nt">&lt;/filter&gt;</span>

    <span class="nt">&lt;filter-mapping&gt;</span>
        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
    <span class="nt">&lt;/filter-mapping&gt;</span>
<span class="nt">&lt;/web-app&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>6、创建 struts.xml</p>

<p>src/main/resources 目录下创建 struts.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE struts PUBLIC
</span><span class="cp">    &#34;-//Apache Software Foundation//DTD Struts Configuration 2.5//EN&#34;
</span><span class="cp">    &#34;http://struts.apache.org/dtds/struts-2.5.dtd&#34;&gt;</span>
<span class="nt">&lt;struts&gt;</span>

    <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.devMode&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;helloworld&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;result&gt;</span>/index.jsp<span class="nt">&lt;/result&gt;</span>
        <span class="nt">&lt;/action&gt;</span>
    <span class="nt">&lt;/package&gt;</span>
<span class="nt">&lt;/struts&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p><code>index.action</code> 请求会重定向到 <code>index.jsp</code>。</p>

<h2 id="7-构建并运行程序">7、构建并运行程序</h2>

<p>运行 <code>mvn jetty:run</code> 访问 <a href="http://localhost:8080/helloworld/index.action">http://localhost:8080/helloworld/index.action</a> 和 <a href="http://localhost:8080/helloworld/index.jsp">http://localhost:8080/helloworld/index.jsp</a> 会看到一样的内容。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">Welcome To Struts 2!</pre></td></tr></table>
</div>
</div>
<h2 id="8-创建-model-类">8、创建 Model 类</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nf">org</span><span class="p">.</span><span class="na">apache</span><span class="p">.</span><span class="na">struts</span><span class="p">.</span><span class="na">helloworld</span><span class="p">.</span><span class="na">model</span><span class="p">;</span>

<span class="kd">public</span> <span class="nf">class</span> <span class="n">MessageStore</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="nf">String</span> <span class="n">message</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">MessageStore</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;Hello Struts User&#34;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">String</span> <span class="n">getMessage</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="9-创建-action-类">9、创建 Action 类</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nf">org</span><span class="p">.</span><span class="na">apache</span><span class="p">.</span><span class="na">struts</span><span class="p">.</span><span class="na">helloworld</span><span class="p">.</span><span class="na">action</span><span class="p">;</span>

<span class="kn">import</span> <span class="nf">org</span><span class="p">.</span><span class="na">apache</span><span class="p">.</span><span class="na">struts</span><span class="p">.</span><span class="na">helloworld</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">MessageStore</span><span class="p">;</span>

<span class="kn">import</span> <span class="nf">com</span><span class="p">.</span><span class="na">opensymphony</span><span class="p">.</span><span class="na">xwork2</span><span class="p">.</span><span class="na">ActionSupport</span><span class="p">;</span>

<span class="kd">public</span> <span class="nf">class</span> <span class="n">HelloWorldAction</span> <span class="nf">extends</span> <span class="n">ActionSupport</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="nf">MessageStore</span> <span class="n">messageStore</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">String</span> <span class="n">execute</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">messageStore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MessageStore</span><span class="p">()</span> <span class="p">;</span>

        <span class="k">return</span> <span class="n">SUCCESS</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">MessageStore</span> <span class="n">getMessageStore</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">messageStore</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="10-创建视图">10、创建视图</h2>

<p>在src/main/resources目录创建 HelloWorld.jsp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></pre></td>
<td class="lntd">
<pre class="chroma">&lt;!DOCTYPE html&gt;
&lt;%@ page language=&#34;java&#34; contentType=&#34;text/html; charset=UTF-8&#34; pageEncoding=&#34;UTF-8&#34; %&gt;
&lt;%@ taglib prefix=&#34;s&#34; uri=&#34;/struts-tags&#34; %&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;&gt;
    &lt;title&gt;Hello World!&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h2&gt;&lt;s:property value=&#34;messageStore.message&#34; /&gt;&lt;/h2&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></td></tr></table>
</div>
</div>
<p><code>&lt;s:property&gt;</code> 标签返回的是 <code>HelloWorldAction</code> 类的 <code>getMessageStore()</code>方法的值。<code>.message</code>返回的是 <code>MessageStore</code> 对象的 <code>getMessage</code> 方法的值。</p>

<h2 id="11-修改-struts-xml">11、修改 struts.xml</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE struts PUBLIC
</span><span class="cp">      &#34;-//Apache Software Foundation//DTD Struts Configuration 2.5//EN&#34;
</span><span class="cp">      &#34;http://struts.apache.org/dtds/struts-2.5.dtd&#34;&gt;</span>

<span class="nt">&lt;struts&gt;</span>

   <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.devMode&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;helloworld&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;result&gt;</span>/index.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>

      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;hello&#34;</span> <span class="na">class=</span><span class="s">&#34;org.apache.struts.helloworld.action.HelloWorldAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/HelloWorld.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>
   <span class="nt">&lt;/package&gt;</span>
<span class="nt">&lt;/struts&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="12-修改-index-jsp">12、修改 index.jsp</h2>

<p>添加url链接：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></pre></td>
<td class="lntd">
<pre class="chroma">&lt;!DOCTYPE html&gt;
&lt;%@ page language=&#34;java&#34; contentType=&#34;text/html; charset=UTF-8&#34; pageEncoding=&#34;UTF-8&#34; %&gt;
&lt;%@ taglib prefix=&#34;s&#34; uri=&#34;/struts-tags&#34; %&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34;&gt;
        &lt;title&gt;Basic Struts 2 Application - Welcome&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Welcome To Struts 2!&lt;/h1&gt;
        &lt;p&gt;&lt;a href=&#34;&lt;s:url action=&#39;hello&#39;/&gt;&#34;&gt;Hello World&lt;/a&gt;&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre></td></tr></table>
</div>
</div>
<h2 id="13-再次运行应用">13、再次运行应用</h2>

<p>运行 <code>mvn jetty:run</code> 访问 <a href="http://localhost:8080/helloworld/index.action">http://localhost:8080/helloworld/index.action</a> ，再点击页面上的链接，跳转到 HelloWorld.jsp。</p>

<h2 id="14-运行原理">14、运行原理</h2>

<p>1、浏览器访问 <code>hello.action</code>，该请求被 <code>web.xml</code> 中的 <code>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter</code> 过滤器拦截。</p>

<p>2、框架找到名称为<code>hello</code>的<code>ActionMapping</code>，对应类为 <code>HelloWorldAction</code>，然后执行该类的 <code>execute</code> 方法。</p>

<p>3、<code>execute</code> 方法创建 <code>MessageStore</code> 对象，并返回 <code>success</code>，框架找到其对应的视图文件 <code>HelloWorld.jsp</code>。</p>

<p>4、<code>HelloWorld.jsp</code> 页面运行时，<code>&lt;s:property value=&quot;messageStore.message&quot; /&gt;</code> 调用 <code>HelloWorldAction</code> 的对应的方法。</p>

<p>5、HTML 页面返回给浏览器。</p>

<h1 id="struts2配置文件">Struts2配置文件</h1>

<p>Struts2中需要的配置文件有：<strong>web.xml</strong>、<strong>struts.xml</strong>、**struts-config.xml **以及 <strong>struts.properties</strong>。</p>

<h2 id="web-xml">web.xml</h2>

<p>web.xml 配置文件是一种 J2EE 配置文件，决定 servlet 容器的 HTTP 元素需求如何进行处理。</p>

<p>在该文件中定义一个 Filter 来启动Struts2。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">id=</span><span class="s">&#34;WebApp_ID&#34;</span> <span class="na">version=</span><span class="s">&#34;2.4&#34;</span>
  <span class="na">xmlns=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee&#34;</span>
  <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;display-name&gt;</span>Hello World<span class="nt">&lt;/display-name&gt;</span>

    <span class="nt">&lt;welcome-file-list&gt;</span>
        <span class="nt">&lt;welcome-file&gt;</span>index<span class="nt">&lt;/welcome-file&gt;</span>
    <span class="nt">&lt;/welcome-file-list&gt;</span>

    <span class="nt">&lt;filter&gt;</span>
        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
        <span class="nt">&lt;filter-class&gt;</span>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter<span class="nt">&lt;/filter-class&gt;</span>
    <span class="nt">&lt;/filter&gt;</span>

    <span class="nt">&lt;filter-mapping&gt;</span>
        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
    <span class="nt">&lt;/filter-mapping&gt;</span>
<span class="nt">&lt;/web-app&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>我们将Struts2 过滤器映射到 /* ，而不是 /*.action，这意味着所有的url都会被Struts过滤器解析。</p>

<blockquote>
<p>注意：**自2.1.3版本开始，ActionContextCleanUp和FilterDispatcher都由StrutsPrepareAndExecuteFilter代替。</p>
</blockquote>

<h2 id="struts-xml">struts.xml</h2>

<p><strong>struts.xml</strong>文件包含有随着 Action 的开发你将要修改的配置信息。它可用于覆盖应用程序的默认设置，例如：<code>struts.devMode=false</code> 以及其他定义为属性文件的设置。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE struts PUBLIC
</span><span class="cp">      &#34;-//Apache Software Foundation//DTD Struts Configuration 2.5//EN&#34;
</span><span class="cp">      &#34;http://struts.apache.org/dtds/struts-2.5.dtd&#34;&gt;</span>

<span class="nt">&lt;struts&gt;</span>

   <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.devMode&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;helloworld&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;result&gt;</span>/index.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>

      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;hello&#34;</span> <span class="na">class=</span><span class="s">&#34;org.apache.struts.helloworld.action.HelloWorldAction&#34;</span> 
      <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/HelloWorld.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>
   <span class="nt">&lt;/package&gt;</span>
<span class="nt">&lt;/struts&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>所有的 Struts 配置文件都需要有正确的<code>doctype</code>。</p>

<p>1、<code>&lt;struts&gt;</code> 是根标记元素，在其下，我们使用<code>&lt;package&gt;</code>标签声明不同的包。 这里的<code>&lt;package&gt;</code>标签允许配置的分离和模块化。这在你进行一个大的项目并且项目分为多个不同的模块时，是非常有用的。</p>

<p>2、<strong><code>&lt;constant&gt;</code></strong>标签以及 name 和 value 属性将用于覆盖 <strong><code>default.properties</code></strong> 中定义的任一属性。</p>

<p>3、 <code>&lt;package&gt;</code>标签具有以下属性：</p>

<table>
<thead>
<tr>
<th>属性</th>
<th align="left">必须</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td>name</td>
<td align="left">是</td>
<td>为 packag 的唯一标识，必须的。</td>
</tr>

<tr>
<td>extends</td>
<td align="left">否</td>
<td>指定 package 继承另一 package 的所有配置。通常情况下，我们使用<code>struts-default</code> 作为package 的基础。</td>
</tr>

<tr>
<td>abstract</td>
<td align="left">否</td>
<td>定义 package 为抽象的。如果标记为 true，则 package 不能被最终用户使用。</td>
</tr>

<tr>
<td>namespace</td>
<td align="left">否</td>
<td>Action 的唯一命名空间。</td>
</tr>

<tr>
<td>strict-method-invocation</td>
<td align="left">否</td>
<td></td>
</tr>
</tbody>
</table>

<p>4、<strong><code>&lt;action&gt;</code></strong> 标签对应于我们想要访问的每个 URL，并且使用 <code>execute()</code> 方法定义一个访问相应的 URL 时将要访问的类的方法。</p>

<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">必须</th>
<th>描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">name</td>
<td align="left">是</td>
<td>为 packag 的唯一标识，必须的。</td>
</tr>

<tr>
<td align="left">extends</td>
<td align="left">否</td>
<td>Action完整类名。</td>
</tr>

<tr>
<td align="left">abstract</td>
<td align="left">否</td>
<td>定义 package 为抽象的。如果标记为 true，则 package 不能被最终用户使用。</td>
</tr>

<tr>
<td align="left">namespace</td>
<td align="left">否</td>
<td>Action类的类型转换器的完整类名。</td>
</tr>
</tbody>
</table>

<p>说明：</p>

<ul>
<li>action的name属性一般不允许出现<code>.</code>或者<code>/</code>或者<code>-</code>的，但是下划线<code>_</code>是可以的。</li>
<li>如果 class 没有配置，那么框架会调用ActionSupport类中execute方法，该方法的实现仅仅是返回一个SUCCESS，相当于是完成转发功能。</li>
</ul>

<p>5、<code>&lt;Result&gt;</code>  确定在执行操作后返回到浏览器的内容，而从操作返回的字符串应该是结果的名称。</p>

<p><strong>struts.xml</strong> 支持模块化开发，可以 引入多个xml文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE struts PUBLIC
</span><span class="cp">    &#34;-//Apache Software Foundation//DTD Struts Configuration 2.0//EN&#34;
</span><span class="cp">    &#34;http://struts.apache.org/dtds/struts-2.0.dtd&#34;&gt;</span>
<span class="nt">&lt;struts&gt;</span>
     <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&#34;my-struts1.xml&#34;</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&#34;my-struts2.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/struts&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="struts-config-xml">struts-config.xml</h2>

<h2 id="struts-properties">struts.properties</h2>

<p><strong>struts.properties</strong>配置文件中包含的所有属性也可以在<strong>web.xml</strong>中配置使用<strong>init-param</strong>，以及在<strong>struts.xml</strong>配置文件中使用<strong>constant</strong>标签。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-properties" data-lang="properties"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-properties" data-lang="properties">### When set to true, Struts will act much more friendly for developers
struts.devMode = true

### Enables reloading of internationalization files
struts.i18n.reload = true

### Enables reloading of XML configuration files
struts.configuration.xml.reload = true

### Sets the port that the server is run on
struts.url.http.port = 8080</code></pre></td></tr></table>
</div>
</div>
<h2 id="default-properties"><strong>default.properties</strong></h2>

<p>​默认的配置，包含在struts2-core-x.y.z.ja中。</p>

<h1 id="struts2-action">Struts2 Action</h1>

<p>​Actions是Struts2框架的核心，因为它们适用于任何MVC框架。每个URL映射到特定的action，其提供处理来自用户的请求所需的处理逻辑。
​
但action还有另外两个重要的功能。 首先，action在将数据从请求传递到视图方面起着重要作用。 第二，action必须协助框架确定哪个结果应该呈现在响应请求的视图中。</p>

<h2 id="创建action">创建Action</h2>

<p>Struts2中 Action 的唯一要求是必须有一个无参数方法返回 String 或 Result 对象，并且必须是 POJO。如果没有指定 no-argument 方法，则默认是使用 execute() 方法。</p>

<p>你还可以继承ActionSupport类，该类可实现六个接口：Action、Validateable、ValidationAware、TextProvider、LocaleProvider、Serializable。Action的接口如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="nf">interface</span> <span class="n">Action</span> <span class="p">{</span>
   <span class="kd">public</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">String</span> <span class="n">SUCCESS</span> <span class="o">=</span> <span class="s">&#34;success&#34;</span><span class="p">;</span>
   <span class="kd">public</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">String</span> <span class="n">NONE</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">;</span>
   <span class="kd">public</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">String</span> <span class="n">ERROR</span> <span class="o">=</span> <span class="s">&#34;error&#34;</span><span class="p">;</span>
   <span class="kd">public</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">String</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="s">&#34;input&#34;</span><span class="p">;</span>
   <span class="kd">public</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">String</span> <span class="n">LOGIN</span> <span class="o">=</span> <span class="s">&#34;login&#34;</span><span class="p">;</span>
   <span class="kd">public</span> <span class="nf">String</span> <span class="n">execute</span><span class="p">()</span> <span class="kd">throws</span> <span class="nf">Exception</span><span class="p">;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>Action中五种内置属性(com.opensymphony.xwork2.Action)：</p>

<ul>
<li>SUCCESS Action正确的执行完成，返回相应的视图，success是name属性的默认值。</li>
<li>NONE 表示Action正确的执行完成，但并不返回任何事视图。</li>
<li>ERROR 表示Action执行失效，返回错误处理视图。</li>
<li>LOGIN Action因为用户没有登录的原因没有正确执行，将返回该登录视图，要求用户进行登录验证</li>
<li>INPUT Action的执行，需要从前端界面获取参数，INPUT就是代表这个参数输入界面，一般在应用中，会对这些 参数进行验证，如果验证没有通过，将自动返回该视图。</li>
</ul>

<h2 id="多个action方法">多个Action方法</h2>

<p>一个Action中可以配置一个方法，也可以配置多个，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nf">com</span><span class="p">.</span><span class="na">javachen</span><span class="p">.</span><span class="na">action</span><span class="p">;</span>
 
<span class="kn">import</span> <span class="nf">com</span><span class="p">.</span><span class="na">opensymphony</span><span class="p">.</span><span class="na">xwork2</span><span class="p">.</span><span class="na">ActionSupport</span><span class="p">;</span>

<span class="kd">public</span> <span class="nf">class</span> <span class="n">UserAction</span> <span class="nf">extends</span> <span class="n">ActionSupport</span><span class="p">{</span>
  <span class="kd">private</span> <span class="nf">static</span> <span class="kd">final</span> <span class="nf">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="n">1L</span><span class="p">;</span>

  <span class="kd">public</span> <span class="nf">String</span> <span class="n">list</span><span class="p">()</span> <span class="kd">throws</span> <span class="nf">Exception</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="nf">String</span> <span class="n">update</span><span class="p">(){</span>
      <span class="k">return</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="nf">String</span> <span class="n">delete</span><span class="p">(){</span>
      <span class="k">return</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="nf">String</span> <span class="n">add</span><span class="p">(){</span>
      <span class="k">return</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这时候 struts.xml文件如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;user&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/user&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;list&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.UserAction&#34;</span> <span class="na">method=</span><span class="s">&#34;list&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result&gt;</span>/list.jsp<span class="nt">&lt;/result&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;add&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.UserAction&#34;</span> <span class="na">method=</span><span class="s">&#34;add&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result&gt;</span>/add.jsp<span class="nt">&lt;/result&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;delete&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.UserAction&#34;</span> <span class="na">method=</span><span class="s">&#34;delete&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result&gt;</span>/delete.jsp<span class="nt">&lt;/result&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;update&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.UserAction&#34;</span> <span class="na">method=</span><span class="s">&#34;update&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result&gt;</span>/update.jsp<span class="nt">&lt;/result&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/package&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>访问方式：<a href="http://localhost:8080/helloworld/user/list.action">http://localhost:8080/helloworld/user/list.action</a></p>

<h2 id="动态方法调用">动态方法调用</h2>

<p>所谓动态方法调用（Dynamic Method Invocation ，简称DMI）是指在action的名字中使用感叹号<code>!</code>标识需要调用的方法名，调用格式是<code>actionName!actionMethod.action</code>。</p>

<p>struts.xml文件修改为：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.enable.DynamicMethodInvocation&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>  

<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;user&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/user&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;userAction&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.UserAction&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/list.jsp<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;delete&#34;</span><span class="nt">&gt;</span>/delete.jsp<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;add&#34;</span><span class="nt">&gt;</span>/add.jsp<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;update&#34;</span><span class="nt">&gt;</span>/update.jsp<span class="nt">&lt;/result&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/package&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>​访问方式：<a href="http://localhost:8080/helloworld/UserAction!add.action">http://localhost:8080/helloworld/UserAction!add.action</a> (!后面的add表示方法,可以换成update)。</p>

<p>​需要注意的是，尽管DMI给开发带来了诸多遍历，但是存在安全隐患，由于可以通过url直接放完action中任意方法，所以很容易受到恶意攻击。在这种情况下需要使用安全控制机制。</p>

<p>关于method属性与DMI应该使用哪种方式的问题，可以简要总结如下：如果一个action中的不同方法使用相同的配置（相同的result和拦截器配置），那么可以使用DMI；否则使用method属性在struts.xml文件中进行配置。</p>

<h2 id="默认的action">默认的Action</h2>

<p>默认的action是在访问一个不存在的action的时候访问的action，配置默认action，只需要在package中添加如下配置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;user&#34;</span> <span class="na">namespace=</span><span class="s">&#34;/&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;default-action-ref</span> <span class="na">name=</span><span class="s">&#34;hello&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;hello&#34;</span> <span class="na">class=</span><span class="s">&#34;example.HelloWorld&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result&gt;</span>/index.jsp<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/package&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>​这里的action配置在package下面，需要注意的是：每个package可以有一个默认的action，但是每个namespace应该只有一个默认的action，因为使用多个的话，框架不知道访问默认的action。</p>

<h2 id="通配符映射">通配符映射</h2>

<p>​使用通配符映射的方式可以大大减少action的数量，所谓通配符就是使用*，用于匹配0个或多个字符。在action的配置中，可以为name属性使用*来匹配任意的字符。比如下面的配置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;edit*&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.Edit{1}Action&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result&gt;</span>/{1}.jsp<span class="nt">&lt;/result&gt;</span>
<span class="nt">&lt;/action&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>​{1}会被name属性中的*的内容填充，比如在浏览器中访问/editUser，会映射到action.EditUserAction类，返回到User.jsp页面中。其中的{1}实际上就是作为占位符的，大括号的值可以是0-9，其中{0}代表整个请求URL。比如下面的配置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;*_*&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.action.{1}Action&#34;</span> <span class="na">method=</span><span class="s">&#34;{2}&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result&gt;</span>/{1}_{2}.jsp<span class="nt">&lt;/result&gt;</span>
<span class="nt">&lt;/action&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>​访问方式：<a href="http://localhost:8080/hellowolrd/User_list.action">http://localhost:8080/hellowolrd/User_list.action</a></p>

<p>​当访问User_list的时候，会映射到UserAction类，访问UserAction中的list方法，返回的结果页面是User_list.jsp。</p>

<h2 id="修改struts后缀">修改struts后缀</h2>

<p>配置方式（三种）：</p>

<p>1、在struts.xml中加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.action.extension&#34;</span> <span class="na">value=</span><span class="s">&#34;action,do,struts2&#34;</span><span class="nt">&gt;&lt;/constan&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>2、在struts.properties中加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">struts.action.extension=action,do,struts2</code></pre></td></tr></table>
</div>
</div>
<p>3、在web.xml中加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;filter&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;filter-class&gt;</span>org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter<span class="nt">&lt;/filter-class&gt;</span>
    <span class="c">&lt;!--添加内容--&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>struts.action.extension<span class="nt">&lt;/param-name&gt;</span>
        <span class="nt">&lt;param-value&gt;</span>do,action,strtus2<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/init-param&gt;</span>
<span class="nt">&lt;/filter&gt;</span>

<span class="nt">&lt;filter-mapping&gt;</span>
        <span class="nt">&lt;filter-name&gt;</span>struts2<span class="nt">&lt;/filter-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="struts2-result">Struts2 Result</h1>

<p>1、介绍</p>

<p>​用于做输出的组件，用于向页面输出一些内容，转发、重定向可以理解为特殊方式的输出。每一个Result实际上是一个类，这些类都实现了共同的接口Result。</p>

<p>2、Result类型</p>

<p>Struts2预置了10种类型的Result，定义在strtus-default.xml。</p>

<table>
<thead>
<tr>
<th>Type 类型值</th>
<th>作用说明</th>
<th>对应类</th>
</tr>
</thead>

<tbody>
<tr>
<td>chain</td>
<td>用来处理Action 链</td>
<td>com.opensymphony.xwork2.ActionChainResult</td>
</tr>

<tr>
<td><strong>dispatcher（默认值）</strong></td>
<td>用来转向页面，通常处理 JSP</td>
<td>org.apache.struts2.dispatcher.ServletDispatcherResult</td>
</tr>

<tr>
<td>redirect</td>
<td>重定向到一个URL</td>
<td>org.apache.struts2.dispatcher.ServletRedirectResult</td>
</tr>

<tr>
<td>redirectAction</td>
<td>重定向到一个 Action</td>
<td>org.apache.struts2.dispatcher.ServletActionRedirectResult</td>
</tr>

<tr>
<td>plainText</td>
<td>显示源文件内容，如文件源码</td>
<td>org.apache.struts2.dispatcher.PlainTextResult</td>
</tr>

<tr>
<td>freemarker</td>
<td>处理 FreeMarker 模板</td>
<td>org.apache.struts2.views.freemarker.FreemarkerResult</td>
</tr>

<tr>
<td>httpheader</td>
<td>控制特殊 http 行为的结果类型</td>
<td>org.apache.struts2.dispatcher.HttpHeaderResult</td>
</tr>

<tr>
<td>stream</td>
<td>向浏览器发送 InputSream 对象，通常用来处理文件下载，还可用于返回 AJAX 数据。</td>
<td>org.apache.struts2.dispatcher.StreamResult</td>
</tr>

<tr>
<td>velocity</td>
<td>处理 Velocity 模板</td>
<td>org.apache.struts2.dispatcher.VelocityResult</td>
</tr>

<tr>
<td>Postback</td>
<td></td>
<td></td>
</tr>

<tr>
<td>JSON</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>a）<strong>dispatcher</strong>：用于转发的result，可以将请求转发给JSP，这种类型的Result对应的类为ServletDispacherResult，通过default=&ldquo;true&rdquo;指定该Result为Struts2默认的Result类型。</p>

<p>b）<strong>stream</strong>：用于向页面输出二进制数据，此种类型的Result可以将二进制数据输出到请求发起端，对应类为StreamResult。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span> <span class="na">type=</span><span class="s">&#34;stream&#34;</span><span class="nt">&gt;</span>
　　<span class="c">&lt;!--codeStream 为定义在Action的输入流InputStream --&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;inputName&#34;</span><span class="nt">&gt;</span>codeStream<span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;/result&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>c）<strong>redirect</strong>：用于将请求重定向给一个 URL，对应类为 ServletRedirectResult。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;login&#34;</span> <span class="na">type=</span><span class="s">&#34;redirect&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;sucess&#34;</span><span class="nt">&gt;</span>
        /sucess.jsp
    <span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;/result&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>d）<strong>redirectAction</strong>：用于将请求重定向给另外一个 Action，对应类为 ServletActionRedirectResult。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;login&#34;</span> <span class="na">type=</span><span class="s">&#34;redirectAction&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--若重定向的Action与当前Action在同一个namespace下，可以省略namespace--&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;namespace&#34;</span><span class="nt">&gt;</span>
    /命名空间
    <span class="nt">&lt;/param&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;actionName&#34;</span><span class="nt">&gt;</span>
    action名
    <span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;/result&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>e）<strong>json</strong>：用于向页面输出json格式的数据，可以将json字符串输出到请求发起端，对应类为JSONResult。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span> <span class="na">type=</span><span class="s">&#34;json&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--输出一个Action属性
</span><span class="c">    指定属性为基本类型，则直接返回该属性值
</span><span class="c">    如果指定属性为实体对象，则返回格式{&#34;code&#34;:&#34;as1&#34;,&#34;name&#34;:&#34;hk&#34;}
</span><span class="c">    --&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;root&#34;</span><span class="nt">&gt;</span>属性名<span class="nt">&lt;/param&gt;</span>
    <span class="c">&lt;!--输出多个Action属性--&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;includeProperties&#34;</span><span class="nt">&gt;</span>属性名1,属性名2...<span class="nt">&lt;/param&gt;</span>
    <span class="c">&lt;!--输出所有属性，不需要param标签--&gt;</span>
<span class="nt">&lt;/result&gt;</span></code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p><strong>注意</strong>：json需要导包，修改package继承关系为json-default。</p>
</blockquote>

<h1 id="struts2-拦截器">Struts2 <strong>拦截器</strong></h1>

<p>拦截器适合封装一些通用处理，便于重复利用。例如请求参数传递给Action属性，日志的记录，权限检查，事务处理等。拦截器是通过配置方式调用，因此使用方法比较灵活，便于维护和扩展。</p>

<p>Struts 2框架提供了一个良好的开箱即用的拦截器列表，这些拦截器预先配置好并可以使用。 下面列出了几个重要的拦截器：</p>

<table>
<thead>
<tr>
<th align="left">拦截器名称</th>
<th align="left">说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"><strong>alias</strong></td>
<td align="left">允许参数在请求之间使用不同的别名。</td>
</tr>

<tr>
<td align="left"><strong>checkbox</strong></td>
<td align="left">通过为未检查的复选框添加参数值false，以辅助管理复选框。</td>
</tr>

<tr>
<td align="left"><strong>conversionError</strong></td>
<td align="left">将字符串转换为参数类型的错误信息放置到action的错误字段中。</td>
</tr>

<tr>
<td align="left"><strong>createSession</strong></td>
<td align="left">自动创建HTTP会话（如果尚不存在）。</td>
</tr>

<tr>
<td align="left"><strong>debugging</strong></td>
<td align="left">为开发人员提供一些不同的调试屏幕。</td>
</tr>

<tr>
<td align="left"><strong>execAndWait</strong></td>
<td align="left">当action在后台执行时，将用户发送到中间的等待页面。</td>
</tr>

<tr>
<td align="left"><strong>exception</strong></td>
<td align="left">映射从action到结果抛出的异常，允许通过重定向自动处理异常。</td>
</tr>

<tr>
<td align="left"><strong>fileUpload</strong></td>
<td align="left">便于文件上传。</td>
</tr>

<tr>
<td align="left"><strong>i18n</strong></td>
<td align="left">在用户会话期间跟踪选定的区域。</td>
</tr>

<tr>
<td align="left"><strong>logger</strong></td>
<td align="left">通过输出正在执行的action的名称提供简单的日志记录。</td>
</tr>

<tr>
<td align="left"><strong>params</strong></td>
<td align="left">设置action上的请求参数。</td>
</tr>

<tr>
<td align="left"><strong>prepare</strong></td>
<td align="left">这通常用于执行预处理工作，例如设置数据库连接。</td>
</tr>

<tr>
<td align="left"><strong>profile</strong></td>
<td align="left">允许记录action的简单分析信息。</td>
</tr>

<tr>
<td align="left"><strong>scope</strong></td>
<td align="left">在会话或应用程序范围内存储和检索action的状态。</td>
</tr>

<tr>
<td align="left"><strong>ServletConfig</strong></td>
<td align="left">提供可访问各种基于servlet信息的action。</td>
</tr>

<tr>
<td align="left"><strong>timer</strong></td>
<td align="left">以action执行时间的形式提供简单的分析信息。</td>
</tr>

<tr>
<td align="left"><strong>token</strong></td>
<td align="left">检查action的有效性，以防止重复提交表单。</td>
</tr>

<tr>
<td align="left"><strong>validation</strong></td>
<td align="left">提供action的验证支持。</td>
</tr>
</tbody>
</table>

<h2 id="使用拦截器">使用拦截器</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE struts PUBLIC
</span><span class="cp">      &#34;-//Apache Software Foundation//DTD Struts Configuration 2.5//EN&#34;
</span><span class="cp">      &#34;http://struts.apache.org/dtds/struts-2.5.dtd&#34;&gt;</span>

<span class="nt">&lt;struts&gt;</span>

   <span class="nt">&lt;constant</span> <span class="na">name=</span><span class="s">&#34;struts.devMode&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;helloworld&#34;</span> <span class="na">extends=</span><span class="s">&#34;struts-default&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;index&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;result&gt;</span>/index.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>

      <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&#34;hello&#34;</span> <span class="na">class=</span><span class="s">&#34;org.apache.struts.helloworld.action.HelloWorldAction&#34;</span> <span class="na">method=</span><span class="s">&#34;execute&#34;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;params&#34;</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;timer&#34;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;result</span> <span class="na">name=</span><span class="s">&#34;success&#34;</span><span class="nt">&gt;</span>/HelloWorld.jsp<span class="nt">&lt;/result&gt;</span>
      <span class="nt">&lt;/action&gt;</span>
   <span class="nt">&lt;/package&gt;</span>
<span class="nt">&lt;/struts&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="创建自定义拦截器">创建自定义拦截器</h2>

<p>创建自定义拦截器很容易，需要扩展的是以下<strong>Interceptor</strong>接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="nf">interface</span> <span class="n">Interceptor</span> <span class="nf">extends</span> <span class="n">Serializable</span><span class="p">{</span>
   <span class="kt">void</span> <span class="nf">destroy</span><span class="p">();</span>
   <span class="kt">void</span> <span class="nf">init</span><span class="p">();</span>
   <span class="n">String</span> <span class="nf">intercept</span><span class="p">(</span><span class="n">ActionInvocation</span> <span class="nf">invocation</span><span class="p">)</span>
   <span class="kd">throws</span> <span class="nf">Exception</span><span class="p">;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>​init()方法提供了一种初始化拦截器的方法，而destroy()方法为拦截器清理提供了一个工具。与action不同，拦截器在请求之间重复使用，需要线程安全，特别是intercept()方法。</p>

<p>​ActionInvocation对象可访问运行时的环境。它允许访问action本身以及方法来调用action，并确定action是否已被调用。</p>

<p>​如果你不需要初始化或清理代码，可以扩展AbstractInterceptor类，以实现init()和destroy()的默认的无操作指令。</p>

<p>创建以下<strong>MyInterceptor.java</strong>文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nf">com</span><span class="p">.</span><span class="na">javachen</span><span class="p">.</span><span class="na">interceptor</span><span class="p">;</span>

<span class="kn">import</span> <span class="nf">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="o">*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nf">com</span><span class="p">.</span><span class="na">opensymphony</span><span class="p">.</span><span class="na">xwork2</span><span class="p">.</span><span class="na">ActionInvocation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nf">com</span><span class="p">.</span><span class="na">opensymphony</span><span class="p">.</span><span class="na">xwork2</span><span class="p">.</span><span class="na">interceptor</span><span class="p">.</span><span class="na">AbstractInterceptor</span><span class="p">;</span>

<span class="kd">public</span> <span class="nf">class</span> <span class="n">MyInterceptor</span> <span class="nf">extends</span> <span class="n">AbstractInterceptor</span> <span class="p">{</span>

   <span class="kd">public</span> <span class="nf">String</span> <span class="n">intercept</span><span class="p">(</span><span class="n">ActionInvocation</span> <span class="nf">invocation</span><span class="p">)</span><span class="kd">throws</span> <span class="nf">Exception</span><span class="p">{</span>

      <span class="cm">/* let us do some pre-processing */</span>
      <span class="n">String</span> <span class="nf">output</span> <span class="o">=</span> <span class="s">&#34;Pre-Processing&#34;</span><span class="p">;</span> 
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>

      <span class="cm">/* let us call action or next interceptor */</span>
      <span class="n">String</span> <span class="nf">result</span> <span class="o">=</span> <span class="n">invocation</span><span class="p">.</span><span class="na">invoke</span><span class="p">();</span>

      <span class="cm">/* let us do some post-processing */</span>
      <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;Post-Processing&#34;</span><span class="p">;</span> 
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>

      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>你可以发现，实际中action将通过拦截器使用 invocation.invoke() 调用执行，所以你可以根据你的需求做一些预处理和一些后处理。</p>

<p>框架本身通过第一次调用ActionInvocation对象的invoke()来启动进程。每次调用 invoke() 时，ActionInvocation都会查询其状态，并执行下一个拦截器。当所有配置的拦截器都被调用时，invoke()将使得action本身被执行。以下图表通过请求流显示了所说的概念：</p>

<p><img src="https://7n.w3cschool.cn/attachments/tuploads/struts_2/actioninvocation.jpg" alt="ActionInvocation" /></p>

<h2 id="注册拦截器">注册拦截器</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;package&gt;</span>
    <span class="nt">&lt;interceptors&gt;</span>
        <span class="nt">&lt;interceptor</span> <span class="na">name=</span><span class="s">&#34;MyInterceptor&#34;</span> <span class="na">class=</span><span class="s">&#34;com.javachen.interceptor.MyInterceptor&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--其他拦截器--&gt;</span>
    <span class="nt">&lt;/interceptors&gt;</span>
<span class="nt">&lt;/package&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="引用拦截器">引用拦截器</h2>

<p>哪个Action希望被拦截器扩展，需要在此action配置下，引用拦截器。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;action&gt;</span>
　　 <span class="c">&lt;!--手动的使用一次系统默认的拦截器--&gt;</span>
　　 <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;defaultStack&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;MyInterceptor&#34;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!--可以写多个--&gt;</span>
　　 <span class="c">&lt;!--可以使用excludeMethods参数属性，设置不过滤的方法--&gt;</span>
<span class="nt">&lt;/action&gt;</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="拦截器栈">拦截器栈</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;interceptor-stack</span> <span class="na">name=</span><span class="s">&#34;myStack&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;exception&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;servlet-config&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;prepare&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;checkbox&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;params&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;interceptor-ref</span> <span class="na">name=</span><span class="s">&#34;conversionError&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/interceptor-stack&gt;</span></code></pre></td></tr></table>
</div>
</div>
<p>上述的拦截器栈按照它们被配置的顺序执行。例如，在上面的例子中，exception将首先执行，第二个将是servlet-config等。</p>

<h1 id="struts2面试">Struts2面试</h1>

<h2 id="拦截器和过滤器的区别"><strong>拦截器和过滤器的区别</strong></h2>

<p>1、拦截器是基于java反射机制的，而过滤器是基于函数回调的。
2、过滤器依赖于servlet容器，而拦截器不依赖于servlet容器。
3、拦截器只能对Action请求起作用，而过滤器则可以对几乎所有请求起作用。
4、拦截器可以访问Action上下文、值栈里的对象，而过滤器不能。
5、在Action的生命周期中，拦截器可以多次调用，而过滤器只能在容器初始化时被调用一次。</p>

<h2 id="struts1于struts2的比较"><strong>struts1于struts2的比较</strong></h2>

<p><strong>1、Action   类:</strong></p>

<p>​Struts1要求Action类继承一个抽象基类而不是实现接口。</p>

<p>​Struts2  Action类可以实现一个Action接口，也可实现其他接口，使可选和定制的服务成为可能。Struts2提供一个ActionSupport基类去实现常用的接口。Action接口不是必须的，任何有execute标识的POJO对象都可以用作Struts2的Action对象。</p>

<p><strong>2、线程模式:</strong>
Struts1  Action是单例模式并且必须是线程安全的，因为仅有Action的一个实例来处理所有的请求。
Struts2  Action对象为每一个请求产生一个实例，因此没有线程安全问题。</p>

<p><strong>3、Servlet 依赖:</strong>
Struts1 Action依赖于Servlet  API，因为当一个Action被调用时HttpServletRequest和  HttpServletResponse被传递给execute方法。
Struts2 Action不依赖于容器，如果需要，Struts2 Action仍然可以访问初始的request和response。</p>

<p><strong>4、可测性:</strong>
测试Struts1 Action的一个主要问题是execute方法暴露了servlet   API，这使得测试要依赖于容器。
Struts2 Action可以通过初始化、设置属性、调用方法来测试，依赖注入支持也使测试更容易。</p>

<p><strong>5、捕获输入:</strong>
Struts1 使用ActionForm对象捕获输入。所有的ActionForm必须继承一个基类。因为其他JavaBean不能用作ActionForm，开发者经常创建多余的类捕获输入。动态Bean（DynaBeans）可以作为创建传统ActionForm的选择，但是，开发者可能是在重新描述已经存在的JavaBean，仍然会导致有冗余的javabean。
Struts2直接使用Action属性作为输入属性，输入属性可能是有自己(子)属性的rich对象类型。Action属性能够通过 web页面上的taglibs访问。Struts2也支持ActionForm模式。rich对象类型，包括业务对象，能够用作输入/输出对象。这种ModelDriven 特性简化了taglib对POJO输入对象的引用。</p>

<p><strong>6、表达式语言：</strong>
Struts1 整合了JSTL，因此使用JSTL EL。这种EL有基本对象图遍历，但是对集合和索引属性的支持很弱。
Struts2可以使用JSTL，但是也支持一个更强大和灵活的表达式语言&rdquo;Object   Graph   Notation   Language &ldquo;   (OGNL)。</p>

<p><strong>7、绑定值到页面（view）:</strong>
Struts1使用标准JSP机制把对象绑定到页面中来访问。
Struts2 使用&rdquo;ValueStack &ldquo;技术，使taglib能够访问值而不需要把你的页面和对象绑定起来。ValueStack策略允许通过一系列名称相同但类型不同的属性重用页面。</p>

<p><strong>8、类型转换：</strong>
Struts 1 ActionForm属性通常都是String类型。Struts1使用Commons-Beanutils进行类型转换。每个类一个转换器，对每一个实例来说是不可配置的。
  Struts2   使用OGNL进行类型转换。提供基本和常用对象的转换器。</p>

<p><strong>9、校验：</strong></p>

<p>Struts1支持在ActionForm的validate方法中手动校验，或者通过Commons   Validator的扩展来校验。同一个类可以有不同的校验内容，但不能校验子对象。
Struts2支持通过validate方法和XWork校验框架来进行校验。XWork校验框架使用为属性类类型定义的校验和内容校验，来支持chain校验子属性</p>

<p><strong>10、Action执行的控制：</strong></p>

<p>Struts1支持每一个模块有单独的Request Processors（生命周期），但是模块中的所有Action必须共享相同的生命周期。
Struts2支持通过拦截器堆栈为每一个Action创建不同的生命周期。堆栈能够根据需要和不同的Action一起使用。</p>

<h2 id="struts2如何访问httpservletrequest-httpsession-servletcontext三个域对象">struts2如何访问HttpServletRequest、HttpSession、ServletContext三个域对象？</h2>

<p><strong>方案一：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">HttpServletRequest</span> <span class="nf">request</span> <span class="o">=</span><span class="n">ServletActionContext</span><span class="p">.</span><span class="na">getRequest</span><span class="p">();</span> 
<span class="n">HttpServletResponse</span> <span class="nf">response</span> <span class="o">=</span><span class="n">ServletActionContext</span><span class="p">.</span><span class="na">getResponse</span><span class="p">();</span> 
<span class="n">HttpSession</span>  <span class="nf">session</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">();</span>
<span class="n">ServletContext</span> <span class="nf">servletContext</span><span class="o">=</span><span class="n">ServletActionContext</span><span class="p">.</span><span class="na">getServletContext</span><span class="p">();</span>  </code></pre></td></tr></table>
</div>
</div>
<p><strong>方案二：</strong></p>

<p>​Struts2操作类不提供对Servlet API组件的直接访问，例如Request，Response和Session。但是，有时我们需要在操作类中进行这些访问，例如检查HTTP方法或设置响应中的cookie。</p>

<p>​这就是为什么Struts2 API提供了一堆Aware接口，我们可以实现这些接口来访问这些对象。Struts2 API使用依赖注入在操作类中注入Servlet API组件。一些重要的Aware接口是SessionAware，ApplicationAware，ServletRequestAware和ServletResponseAware。</p>

<h2 id="struts2如何对指定的方法进行验证"><strong>struts2如何对指定的方法进行验证？</strong></h2>

<ul>
<li>1）<code>validate()</code>方法会校验action中所有与<code>execute方</code>法签名相同的方法；</li>
<li>2）要校验指定的方法通过重写<code>validateXxx()</code>方法实现， <code>validateXxx()</code>只会校验action中方法名为<code>Xxx</code>的方法。其中<code>Xxx</code>的第一个字母要大写；</li>
<li>3）当某个数据校验失败时，调用<code>addFieldError()</code>方法往系统的<code>fieldErrors</code>添加校验失败信息（为了<code>使用addFieldError()</code>方法，action可以继承ActionSupport）， 如果系统 的fieldErrors包含失败信息，struts2会将请求转发到名为input的result；</li>
<li>4）在input视图中可以通过<code>&lt;s:fielderror/&gt;</code>显示失败信息。</li>
<li>5）先执行<code>validateXxxx()-&gt;validate()-&gt;</code>如果出错了，会转发<code>&lt;result name=&quot;input&quot;/&gt;</code>所指定的页面，如果不出错，会直接进行<code>Action::execute()</code>方法</li>
</ul>

<h2 id="struts2默认能解决get和post提交方式的乱码问题吗"><strong>struts2默认能解决get和post提交方式的乱码问题吗？</strong></h2>

<p>不能。<code>struts.i18n.encoding=UTF-8</code>属性值只能解析POST提交下的乱码问题。</p>

<h2 id="拦截器的生命周期与工作过程"><strong>拦截器的生命周期与工作过程？</strong></h2>

<ul>
<li>1、每个拦截器都是实现了Interceptor接口的 Java 类；</li>
<li>2、init(): 该方法将在拦截器被创建后立即被调用, 它在拦截器的生命周期内只被调用一次. 可以在该方法中对相关资源进行必要的初始化；</li>
<li>3、intercept(ActionInvocation invocation): 每拦截一个动作请求, 该方法就会被调用一次；</li>
<li>4、destroy: 该方法将在拦截器被销毁之前被调用, 它在拦截器的生命周期内也只被调用一次；</li>
<li>5、struts2中有内置了18个拦截器。</li>
</ul>

<h1 id="参考文章">参考文章</h1>

<ul>
<li><a href="https://www.w3cschool.cn/struts_2/struts_result_types.html">Struts2教程</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">JavaChen</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2019-07-01
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechatpay.jpg">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay.jpg">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/struts2/">struts2</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2019/07/15/apollo/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">安装阿波罗配置中心</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2019/06/29/jsf/">
            <span class="next-text nav-default">Java Server Faces</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="javachen/javachen.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:junecloud@163.com" class="iconfont icon-email" title="email"></a>
      <a href="http://github.com/javachen" class="iconfont icon-github" title="github"></a>
      <a href="http://weibo.com/chenzhijun" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://space.bilibili.com/287563020/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://javachen.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2009 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">JavaChen</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.20b54c22.min.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?7eaf37274cf8796df56903a88389e82f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
